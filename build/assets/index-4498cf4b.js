import{r as E,j as S,o as Kt,p as Ne,q as Ie,s as j,g as L,F as V,t as Qt,c as Zt,A as $e,v as Re,i as Pe,w as De,H as je,x as Fe}from"./index-579ca493.js";import{a as Be,d as wt,t as Jt,n as Xe,q as te,u as ut,b as U,c as Ve,e as We,I as Le,f as Et,g as ee,h as Ye}from"./index-a797b5de.js";import{i as st,c as Bt,a as Xt,b as Oe,o as Ge,S as He,R as Ue,s as Ct,M as qe}from"./index-3d2a273d.js";import{U as Ke}from"./index-da998cc0.js";import{M as Qe,V as Ze}from"./index-3ea25930.js";import"./ClipLoader-9d2b9a7c.js";import"./Skeleton-e2aaa283.js";import"./index-1e45b401.js";import"./SoundIcon-f04d7820.js";import"./CheckIcon-4374449d.js";import"./Stack-f04f5560.js";import"./clsx-9050955a.js";import"./FormControlLabel-83fbdbd5.js";import"./Typography-5b66e973.js";import"./createSvgIcon-038b2cbb.js";import"./isPlainObject-2f55db6a.js";import"./index-914a935f.js";import"./index-0b9cdcd8.js";import"./index-7aa175eb.js";import"./three.module-4d3d7244.js";import"./TextareaAutosize-ea4f702b.js";import"./index-9189cd3e.js";import"./SourcesTableIcon-0c44224f.js";import"./DeleteNodeIcon-cd75ed09.js";import"./SucessFeedBackIcon-36d111e2.js";function Vt(t,e,n){var r=new Be;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var zt="http://www.w3.org/1999/xhtml";const Wt={svg:"http://www.w3.org/2000/svg",xhtml:zt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function bt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Wt.hasOwnProperty(e)?{space:Wt[e],local:t}:t}function Je(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===zt&&e.documentElement.namespaceURI===zt?e.createElement(t):e.createElementNS(n,t)}}function tn(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ne(t){var e=bt(t);return(e.local?tn:Je)(e)}function en(){}function Pt(t){return t==null?en:function(){return this.querySelector(t)}}function nn(t){typeof t!="function"&&(t=Pt(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,u=r[i]=new Array(s),c,a,l=0;l<s;++l)(c=o[l])&&(a=t.call(c,c.__data__,l,o))&&("__data__"in c&&(a.__data__=c.__data__),u[l]=a);return new O(r,this._parents)}function rn(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function on(){return[]}function re(t){return t==null?on:function(){return this.querySelectorAll(t)}}function sn(t){return function(){return rn(t.apply(this,arguments))}}function an(t){typeof t=="function"?t=sn(t):t=re(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s=e[o],u=s.length,c,a=0;a<u;++a)(c=s[a])&&(r.push(t.call(c,c.__data__,a,s)),i.push(c));return new O(r,i)}function ie(t){return function(){return this.matches(t)}}function oe(t){return function(e){return e.matches(t)}}var un=Array.prototype.find;function cn(t){return function(){return un.call(this.children,t)}}function ln(){return this.firstElementChild}function fn(t){return this.select(t==null?ln:cn(typeof t=="function"?t:oe(t)))}var hn=Array.prototype.filter;function pn(){return Array.from(this.children)}function dn(t){return function(){return hn.call(this.children,t)}}function gn(t){return this.selectAll(t==null?pn:dn(typeof t=="function"?t:oe(t)))}function mn(t){typeof t!="function"&&(t=ie(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,u=r[i]=[],c,a=0;a<s;++a)(c=o[a])&&t.call(c,c.__data__,a,o)&&u.push(c);return new O(r,this._parents)}function se(t){return new Array(t.length)}function yn(){return new O(this._enter||this._groups.map(se),this._parents)}function _t(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}_t.prototype={constructor:_t,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function vn(t){return function(){return t}}function xn(t,e,n,r,i,o){for(var s=0,u,c=e.length,a=o.length;s<a;++s)(u=e[s])?(u.__data__=o[s],r[s]=u):n[s]=new _t(t,o[s]);for(;s<c;++s)(u=e[s])&&(i[s]=u)}function _n(t,e,n,r,i,o,s){var u,c,a=new Map,l=e.length,_=o.length,p=new Array(l),f;for(u=0;u<l;++u)(c=e[u])&&(p[u]=f=s.call(c,c.__data__,u,e)+"",a.has(f)?i[u]=c:a.set(f,c));for(u=0;u<_;++u)f=s.call(t,o[u],u,o)+"",(c=a.get(f))?(r[u]=c,c.__data__=o[u],a.delete(f)):n[u]=new _t(t,o[u]);for(u=0;u<l;++u)(c=e[u])&&a.get(p[u])===c&&(i[u]=c)}function wn(t){return t.__data__}function bn(t,e){if(!arguments.length)return Array.from(this,wn);var n=e?_n:xn,r=this._parents,i=this._groups;typeof t!="function"&&(t=vn(t));for(var o=i.length,s=new Array(o),u=new Array(o),c=new Array(o),a=0;a<o;++a){var l=r[a],_=i[a],p=_.length,f=Sn(t.call(l,l&&l.__data__,a,r)),v=f.length,m=u[a]=new Array(v),x=s[a]=new Array(v),h=c[a]=new Array(p);n(l,_,m,x,h,f,e);for(var w=0,M=0,g,k;w<v;++w)if(g=m[w]){for(w>=M&&(M=w+1);!(k=x[M])&&++M<v;);g._next=k||null}}return s=new O(s,r),s._enter=u,s._exit=c,s}function Sn(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Mn(){return new O(this._exit||this._groups.map(se),this._parents)}function Cn(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Tn(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,s=Math.min(i,o),u=new Array(i),c=0;c<s;++c)for(var a=n[c],l=r[c],_=a.length,p=u[c]=new Array(_),f,v=0;v<_;++v)(f=a[v]||l[v])&&(p[v]=f);for(;c<i;++c)u[c]=n[c];return new O(u,this._parents)}function kn(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function An(t){t||(t=En);function e(_,p){return _&&p?t(_.__data__,p.__data__):!_-!p}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],u=s.length,c=i[o]=new Array(u),a,l=0;l<u;++l)(a=s[l])&&(c[l]=a);c.sort(e)}return new O(i,this._parents).order()}function En(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function zn(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Nn(){return Array.from(this)}function In(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function $n(){let t=0;for(const e of this)++t;return t}function Rn(){return!this.node()}function Pn(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,s=i.length,u;o<s;++o)(u=i[o])&&t.call(u,u.__data__,o,i);return this}function Dn(t){return function(){this.removeAttribute(t)}}function jn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Fn(t,e){return function(){this.setAttribute(t,e)}}function Bn(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Xn(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Vn(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Wn(t,e){var n=bt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?jn:Dn:typeof e=="function"?n.local?Vn:Xn:n.local?Bn:Fn)(n,e))}function ae(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ln(t){return function(){this.style.removeProperty(t)}}function Yn(t,e,n){return function(){this.style.setProperty(t,e,n)}}function On(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Gn(t,e,n){return arguments.length>1?this.each((e==null?Ln:typeof e=="function"?On:Yn)(t,e,n??"")):lt(this.node(),t)}function lt(t,e){return t.style.getPropertyValue(e)||ae(t).getComputedStyle(t,null).getPropertyValue(e)}function Hn(t){return function(){delete this[t]}}function Un(t,e){return function(){this[t]=e}}function qn(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Kn(t,e){return arguments.length>1?this.each((e==null?Hn:typeof e=="function"?qn:Un)(t,e)):this.node()[t]}function ue(t){return t.trim().split(/^|\s+/)}function Dt(t){return t.classList||new ce(t)}function ce(t){this._node=t,this._names=ue(t.getAttribute("class")||"")}ce.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function le(t,e){for(var n=Dt(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function fe(t,e){for(var n=Dt(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Qn(t){return function(){le(this,t)}}function Zn(t){return function(){fe(this,t)}}function Jn(t,e){return function(){(e.apply(this,arguments)?le:fe)(this,t)}}function tr(t,e){var n=ue(t+"");if(arguments.length<2){for(var r=Dt(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Jn:e?Qn:Zn)(n,e))}function er(){this.textContent=""}function nr(t){return function(){this.textContent=t}}function rr(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ir(t){return arguments.length?this.each(t==null?er:(typeof t=="function"?rr:nr)(t)):this.node().textContent}function or(){this.innerHTML=""}function sr(t){return function(){this.innerHTML=t}}function ar(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function ur(t){return arguments.length?this.each(t==null?or:(typeof t=="function"?ar:sr)(t)):this.node().innerHTML}function cr(){this.nextSibling&&this.parentNode.appendChild(this)}function lr(){return this.each(cr)}function fr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hr(){return this.each(fr)}function pr(t){var e=typeof t=="function"?t:ne(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function dr(){return null}function gr(t,e){var n=typeof t=="function"?t:ne(t),r=e==null?dr:typeof e=="function"?e:Pt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function mr(){var t=this.parentNode;t&&t.removeChild(this)}function yr(){return this.each(mr)}function vr(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function xr(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function _r(t){return this.select(t?xr:vr)}function wr(t){return arguments.length?this.property("__data__",t):this.node().__data__}function br(t){return function(e){t.call(this,e,this.__data__)}}function Sr(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Mr(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Cr(t,e,n){return function(){var r=this.__on,i,o=br(e);if(r){for(var s=0,u=r.length;s<u;++s)if((i=r[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Tr(t,e,n){var r=Sr(t+""),i,o=r.length,s;if(arguments.length<2){var u=this.node().__on;if(u){for(var c=0,a=u.length,l;c<a;++c)for(i=0,l=u[c];i<o;++i)if((s=r[i]).type===l.type&&s.name===l.name)return l.value}return}for(u=e?Cr:Mr,i=0;i<o;++i)this.each(u(r[i],e,n));return this}function he(t,e,n){var r=ae(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function kr(t,e){return function(){return he(this,t,e)}}function Ar(t,e){return function(){return he(this,t,e.apply(this,arguments))}}function Er(t,e){return this.each((typeof e=="function"?Ar:kr)(t,e))}function*zr(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,s;i<o;++i)(s=r[i])&&(yield s)}var pe=[null];function O(t,e){this._groups=t,this._parents=e}function pt(){return new O([[document.documentElement]],pe)}function Nr(){return this}O.prototype=pt.prototype={constructor:O,select:nn,selectAll:an,selectChild:fn,selectChildren:gn,filter:mn,data:bn,enter:yn,exit:Mn,join:Cn,merge:Tn,selection:Nr,order:kn,sort:An,call:zn,nodes:Nn,node:In,size:$n,empty:Rn,each:Pn,attr:Wn,style:Gn,property:Kn,classed:tr,text:ir,html:ur,raise:lr,lower:hr,append:pr,insert:gr,remove:yr,clone:_r,datum:wr,on:Tr,dispatch:Er,[Symbol.iterator]:zr};function Q(t){return typeof t=="string"?new O([[document.querySelector(t)]],[document.documentElement]):new O([[t]],pe)}function Ir(t){let e;for(;e=t.sourceEvent;)t=e;return t}function nt(t,e){if(t=Ir(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const $r={passive:!1},ht={capture:!0,passive:!1};function Tt(t){t.stopImmediatePropagation()}function ct(t){t.preventDefault(),t.stopImmediatePropagation()}function de(t){var e=t.document.documentElement,n=Q(t).on("dragstart.drag",ct,ht);"onselectstart"in e?n.on("selectstart.drag",ct,ht):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function ge(t,e){var n=t.document.documentElement,r=Q(t).on("dragstart.drag",null);e&&(r.on("click.drag",ct,ht),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const dt=t=>()=>t;function Nt(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:o,x:s,y:u,dx:c,dy:a,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:a,enumerable:!0,configurable:!0},_:{value:l}})}Nt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Rr(t){return!t.ctrlKey&&!t.button}function Pr(){return this.parentNode}function Dr(t,e){return e??{x:t.x,y:t.y}}function jr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Fr(){var t=Rr,e=Pr,n=Dr,r=jr,i={},o=wt("start","drag","end"),s=0,u,c,a,l,_=0;function p(g){g.on("mousedown.drag",f).filter(r).on("touchstart.drag",x).on("touchmove.drag",h,$r).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(g,k){if(!(l||!t.call(this,g,k))){var A=M(this,e.call(this,g,k),g,k,"mouse");A&&(Q(g.view).on("mousemove.drag",v,ht).on("mouseup.drag",m,ht),de(g.view),Tt(g),a=!1,u=g.clientX,c=g.clientY,A("start",g))}}function v(g){if(ct(g),!a){var k=g.clientX-u,A=g.clientY-c;a=k*k+A*A>_}i.mouse("drag",g)}function m(g){Q(g.view).on("mousemove.drag mouseup.drag",null),ge(g.view,a),ct(g),i.mouse("end",g)}function x(g,k){if(t.call(this,g,k)){var A=g.changedTouches,N=e.call(this,g,k),I=A.length,P,R;for(P=0;P<I;++P)(R=M(this,N,g,k,A[P].identifier,A[P]))&&(Tt(g),R("start",g,A[P]))}}function h(g){var k=g.changedTouches,A=k.length,N,I;for(N=0;N<A;++N)(I=i[k[N].identifier])&&(ct(g),I("drag",g,k[N]))}function w(g){var k=g.changedTouches,A=k.length,N,I;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),N=0;N<A;++N)(I=i[k[N].identifier])&&(Tt(g),I("end",g,k[N]))}function M(g,k,A,N,I,P){var R=o.copy(),D=nt(P||A,k),W,F,d;if((d=n.call(g,new Nt("beforestart",{sourceEvent:A,target:p,identifier:I,active:s,x:D[0],y:D[1],dx:0,dy:0,dispatch:R}),N))!=null)return W=d.x-D[0]||0,F=d.y-D[1]||0,function b(y,C,T){var z=D,$;switch(y){case"start":i[I]=b,$=s++;break;case"end":delete i[I],--s;case"drag":D=nt(T||C,k),$=s;break}R.call(y,g,new Nt(y,{sourceEvent:C,subject:d,target:p,identifier:I,active:$,x:D[0]+W,y:D[1]+F,dx:D[0]-z[0],dy:D[1]-z[1],dispatch:R}),N)}}return p.filter=function(g){return arguments.length?(t=typeof g=="function"?g:dt(!!g),p):t},p.container=function(g){return arguments.length?(e=typeof g=="function"?g:dt(g),p):e},p.subject=function(g){return arguments.length?(n=typeof g=="function"?g:dt(g),p):n},p.touchable=function(g){return arguments.length?(r=typeof g=="function"?g:dt(!!g),p):r},p.on=function(){var g=o.on.apply(o,arguments);return g===o?p:g},p.clickDistance=function(g){return arguments.length?(_=(g=+g)*g,p):Math.sqrt(_)},p}var Lt=180/Math.PI,It={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function me(t,e,n,r,i,o){var s,u,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,c/=u),t*r<e*n&&(t=-t,e=-e,c=-c,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Lt,skewX:Math.atan(c)*Lt,scaleX:s,scaleY:u}}var gt;function Br(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?It:me(e.a,e.b,e.c,e.d,e.e,e.f)}function Xr(t){return t==null||(gt||(gt=document.createElementNS("http://www.w3.org/2000/svg","g")),gt.setAttribute("transform",t),!(t=gt.transform.baseVal.consolidate()))?It:(t=t.matrix,me(t.a,t.b,t.c,t.d,t.e,t.f))}function ye(t,e,n,r){function i(a){return a.length?a.pop()+" ":""}function o(a,l,_,p,f,v){if(a!==_||l!==p){var m=f.push("translate(",null,e,null,n);v.push({i:m-4,x:st(a,_)},{i:m-2,x:st(l,p)})}else(_||p)&&f.push("translate("+_+e+p+n)}function s(a,l,_,p){a!==l?(a-l>180?l+=360:l-a>180&&(a+=360),p.push({i:_.push(i(_)+"rotate(",null,r)-2,x:st(a,l)})):l&&_.push(i(_)+"rotate("+l+r)}function u(a,l,_,p){a!==l?p.push({i:_.push(i(_)+"skewX(",null,r)-2,x:st(a,l)}):l&&_.push(i(_)+"skewX("+l+r)}function c(a,l,_,p,f,v){if(a!==_||l!==p){var m=f.push(i(f)+"scale(",null,",",null,")");v.push({i:m-4,x:st(a,_)},{i:m-2,x:st(l,p)})}else(_!==1||p!==1)&&f.push(i(f)+"scale("+_+","+p+")")}return function(a,l){var _=[],p=[];return a=t(a),l=t(l),o(a.translateX,a.translateY,l.translateX,l.translateY,_,p),s(a.rotate,l.rotate,_,p),u(a.skewX,l.skewX,_,p),c(a.scaleX,a.scaleY,l.scaleX,l.scaleY,_,p),a=l=null,function(f){for(var v=-1,m=p.length,x;++v<m;)_[(x=p[v]).i]=x.x(f);return _.join("")}}}var Vr=ye(Br,"px, ","px)","deg)"),Wr=ye(Xr,", ",")",")"),Lr=1e-12;function Yt(t){return((t=Math.exp(t))+1/t)/2}function Yr(t){return((t=Math.exp(t))-1/t)/2}function Or(t){return((t=Math.exp(2*t))-1)/(t+1)}const Gr=function t(e,n,r){function i(o,s){var u=o[0],c=o[1],a=o[2],l=s[0],_=s[1],p=s[2],f=l-u,v=_-c,m=f*f+v*v,x,h;if(m<Lr)h=Math.log(p/a)/e,x=function(N){return[u+N*f,c+N*v,a*Math.exp(e*N*h)]};else{var w=Math.sqrt(m),M=(p*p-a*a+r*m)/(2*a*n*w),g=(p*p-a*a-r*m)/(2*p*n*w),k=Math.log(Math.sqrt(M*M+1)-M),A=Math.log(Math.sqrt(g*g+1)-g);h=(A-k)/e,x=function(N){var I=N*h,P=Yt(k),R=a/(n*w)*(P*Or(e*I+k)-Yr(k));return[u+R*f,c+R*v,a*P/Yt(e*I+k)]}}return x.duration=h*1e3*e/Math.SQRT2,x}return i.rho=function(o){var s=Math.max(.001,+o),u=s*s,c=u*u;return t(s,u,c)},i}(Math.SQRT2,2,4);var Hr=wt("start","end","cancel","interrupt"),Ur=[],ve=0,Ot=1,$t=2,yt=3,Gt=4,Rt=5,vt=6;function St(t,e,n,r,i,o){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;qr(t,n,{name:e,index:r,group:i,on:Hr,tween:Ur,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ve})}function jt(t,e){var n=q(t,e);if(n.state>ve)throw new Error("too late; already scheduled");return n}function Z(t,e){var n=q(t,e);if(n.state>yt)throw new Error("too late; already running");return n}function q(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function qr(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Jt(o,0,n.time);function o(a){n.state=Ot,n.timer.restart(s,n.delay,n.time),n.delay<=a&&s(a-n.delay)}function s(a){var l,_,p,f;if(n.state!==Ot)return c();for(l in r)if(f=r[l],f.name===n.name){if(f.state===yt)return Vt(s);f.state===Gt?(f.state=vt,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete r[l]):+l<e&&(f.state=vt,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete r[l])}if(Vt(function(){n.state===yt&&(n.state=Gt,n.timer.restart(u,n.delay,n.time),u(a))}),n.state=$t,n.on.call("start",t,t.__data__,n.index,n.group),n.state===$t){for(n.state=yt,i=new Array(p=n.tween.length),l=0,_=-1;l<p;++l)(f=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++_]=f);i.length=_+1}}function u(a){for(var l=a<n.duration?n.ease.call(null,a/n.duration):(n.timer.restart(c),n.state=Rt,1),_=-1,p=i.length;++_<p;)i[_].call(t,l);n.state===Rt&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=vt,n.timer.stop(),delete r[e];for(var a in r)return;delete t.__transition}}function xt(t,e){var n=t.__transition,r,i,o=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){o=!1;continue}i=r.state>$t&&r.state<Rt,r.state=vt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}o&&delete t.__transition}}function Kr(t){return this.each(function(){xt(this,t)})}function Qr(t,e){var n,r;return function(){var i=Z(this,t),o=i.tween;if(o!==n){r=n=o;for(var s=0,u=r.length;s<u;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Zr(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=Z(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var u={name:e,value:n},c=0,a=i.length;c<a;++c)if(i[c].name===e){i[c]=u;break}c===a&&i.push(u)}o.tween=i}}function Jr(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=q(this.node(),n).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((e==null?Qr:Zr)(n,t,e))}function Ft(t,e,n){var r=t._id;return t.each(function(){var i=Z(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return q(i,r).value[e]}}function xe(t,e){var n;return(typeof e=="number"?st:e instanceof Bt?Xt:(n=Bt(e))?(e=n,Xt):Oe)(t,e)}function ti(t){return function(){this.removeAttribute(t)}}function ei(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ni(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttribute(t);return s===i?null:s===r?o:o=e(r=s,n)}}function ri(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?o:o=e(r=s,n)}}function ii(t,e,n){var r,i,o;return function(){var s,u=n(this),c;return u==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=u+"",s===c?null:s===r&&c===i?o:(i=c,o=e(r=s,u)))}}function oi(t,e,n){var r,i,o;return function(){var s,u=n(this),c;return u==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=u+"",s===c?null:s===r&&c===i?o:(i=c,o=e(r=s,u)))}}function si(t,e){var n=bt(t),r=n==="transform"?Wr:xe;return this.attrTween(t,typeof e=="function"?(n.local?oi:ii)(n,r,Ft(this,"attr."+t,e)):e==null?(n.local?ei:ti)(n):(n.local?ri:ni)(n,r,e))}function ai(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function ui(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ci(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&ui(t,o)),n}return i._value=e,i}function li(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&ai(t,o)),n}return i._value=e,i}function fi(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=bt(t);return this.tween(n,(r.local?ci:li)(r,e))}function hi(t,e){return function(){jt(this,t).delay=+e.apply(this,arguments)}}function pi(t,e){return e=+e,function(){jt(this,t).delay=e}}function di(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?hi:pi)(e,t)):q(this.node(),e).delay}function gi(t,e){return function(){Z(this,t).duration=+e.apply(this,arguments)}}function mi(t,e){return e=+e,function(){Z(this,t).duration=e}}function yi(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?gi:mi)(e,t)):q(this.node(),e).duration}function vi(t,e){if(typeof e!="function")throw new Error;return function(){Z(this,t).ease=e}}function xi(t){var e=this._id;return arguments.length?this.each(vi(e,t)):q(this.node(),e).ease}function _i(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Z(this,t).ease=n}}function wi(t){if(typeof t!="function")throw new Error;return this.each(_i(this._id,t))}function bi(t){typeof t!="function"&&(t=ie(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,u=r[i]=[],c,a=0;a<s;++a)(c=o[a])&&t.call(c,c.__data__,a,o)&&u.push(c);return new it(r,this._parents,this._name,this._id)}function Si(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),u=0;u<o;++u)for(var c=e[u],a=n[u],l=c.length,_=s[u]=new Array(l),p,f=0;f<l;++f)(p=c[f]||a[f])&&(_[f]=p);for(;u<r;++u)s[u]=e[u];return new it(s,this._parents,this._name,this._id)}function Mi(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Ci(t,e,n){var r,i,o=Mi(e)?jt:Z;return function(){var s=o(this,t),u=s.on;u!==r&&(i=(r=u).copy()).on(e,n),s.on=i}}function Ti(t,e){var n=this._id;return arguments.length<2?q(this.node(),n).on.on(t):this.each(Ci(n,t,e))}function ki(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Ai(){return this.on("end.remove",ki(this._id))}function Ei(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Pt(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var u=r[s],c=u.length,a=o[s]=new Array(c),l,_,p=0;p<c;++p)(l=u[p])&&(_=t.call(l,l.__data__,p,u))&&("__data__"in l&&(_.__data__=l.__data__),a[p]=_,St(a[p],e,n,p,a,q(l,n)));return new it(o,this._parents,e,n)}function zi(t){var e=this._name,n=this._id;typeof t!="function"&&(t=re(t));for(var r=this._groups,i=r.length,o=[],s=[],u=0;u<i;++u)for(var c=r[u],a=c.length,l,_=0;_<a;++_)if(l=c[_]){for(var p=t.call(l,l.__data__,_,c),f,v=q(l,n),m=0,x=p.length;m<x;++m)(f=p[m])&&St(f,e,n,m,p,v);o.push(p),s.push(l)}return new it(o,s,e,n)}var Ni=pt.prototype.constructor;function Ii(){return new Ni(this._groups,this._parents)}function $i(t,e){var n,r,i;return function(){var o=lt(this,t),s=(this.style.removeProperty(t),lt(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}function _e(t){return function(){this.style.removeProperty(t)}}function Ri(t,e,n){var r,i=n+"",o;return function(){var s=lt(this,t);return s===i?null:s===r?o:o=e(r=s,n)}}function Pi(t,e,n){var r,i,o;return function(){var s=lt(this,t),u=n(this),c=u+"";return u==null&&(c=u=(this.style.removeProperty(t),lt(this,t))),s===c?null:s===r&&c===i?o:(i=c,o=e(r=s,u))}}function Di(t,e){var n,r,i,o="style."+e,s="end."+o,u;return function(){var c=Z(this,t),a=c.on,l=c.value[o]==null?u||(u=_e(e)):void 0;(a!==n||i!==l)&&(r=(n=a).copy()).on(s,i=l),c.on=r}}function ji(t,e,n){var r=(t+="")=="transform"?Vr:xe;return e==null?this.styleTween(t,$i(t,r)).on("end.style."+t,_e(t)):typeof e=="function"?this.styleTween(t,Pi(t,r,Ft(this,"style."+t,e))).each(Di(this._id,t)):this.styleTween(t,Ri(t,r,e),n).on("end.style."+t,null)}function Fi(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Bi(t,e,n){var r,i;function o(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&Fi(t,s,n)),r}return o._value=e,o}function Xi(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Bi(t,e,n??""))}function Vi(t){return function(){this.textContent=t}}function Wi(t){return function(){var e=t(this);this.textContent=e??""}}function Li(t){return this.tween("text",typeof t=="function"?Wi(Ft(this,"text",t)):Vi(t==null?"":t+""))}function Yi(t){return function(e){this.textContent=t.call(this,e)}}function Oi(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Yi(i)),e}return r._value=t,r}function Gi(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Oi(t))}function Hi(){for(var t=this._name,e=this._id,n=we(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],u=s.length,c,a=0;a<u;++a)if(c=s[a]){var l=q(c,e);St(c,t,n,a,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new it(r,this._parents,t,n)}function Ui(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var u={value:s},c={value:function(){--i===0&&o()}};n.each(function(){var a=Z(this,r),l=a.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(c)),a.on=e}),i===0&&o()})}var qi=0;function it(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function we(){return++qi}var et=pt.prototype;it.prototype={constructor:it,select:Ei,selectAll:zi,selectChild:et.selectChild,selectChildren:et.selectChildren,filter:bi,merge:Si,selection:Ii,transition:Hi,call:et.call,nodes:et.nodes,node:et.node,size:et.size,empty:et.empty,each:et.each,on:Ti,attr:si,attrTween:fi,style:ji,styleTween:Xi,text:Li,textTween:Gi,remove:Ai,tween:Jr,delay:di,duration:yi,ease:xi,easeVarying:wi,end:Ui,[Symbol.iterator]:et[Symbol.iterator]};function Ki(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Qi={time:null,delay:0,duration:250,ease:Ki};function Zi(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Ji(t){var e,n;t instanceof it?(e=t._id,t=t._name):(e=we(),(n=Qi).time=Xe(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],u=s.length,c,a=0;a<u;++a)(c=s[a])&&St(c,t,e,a,s,n||Zi(c,e));return new it(r,this._parents,t,e)}pt.prototype.interrupt=Kr;pt.prototype.transition=Ji;function to(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var o,s=n.length,u,c=0,a=0;for(o=0;o<s;++o)u=n[o],c+=u.x,a+=u.y;for(c=(c/s-t)*r,a=(a/s-e)*r,o=0;o<s;++o)u=n[o],u.x-=c,u.y-=a}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(t=+o,i):t},i.y=function(o){return arguments.length?(e=+o,i):e},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function at(t){return function(){return t}}function ot(t){return(t()-.5)*1e-6}function eo(t){return t.x+t.vx}function no(t){return t.y+t.vy}function ro(t){var e,n,r,i=1,o=1;typeof t!="function"&&(t=at(t==null?1:+t));function s(){for(var a,l=e.length,_,p,f,v,m,x,h=0;h<o;++h)for(_=te(e,eo,no).visitAfter(u),a=0;a<l;++a)p=e[a],m=n[p.index],x=m*m,f=p.x+p.vx,v=p.y+p.vy,_.visit(w);function w(M,g,k,A,N){var I=M.data,P=M.r,R=m+P;if(I){if(I.index>p.index){var D=f-I.x-I.vx,W=v-I.y-I.vy,F=D*D+W*W;F<R*R&&(D===0&&(D=ot(r),F+=D*D),W===0&&(W=ot(r),F+=W*W),F=(R-(F=Math.sqrt(F)))/F*i,p.vx+=(D*=F)*(R=(P*=P)/(x+P)),p.vy+=(W*=F)*R,I.vx-=D*(R=1-R),I.vy-=W*R)}return}return g>f+R||A<f-R||k>v+R||N<v-R}}function u(a){if(a.data)return a.r=n[a.data.index];for(var l=a.r=0;l<4;++l)a[l]&&a[l].r>a.r&&(a.r=a[l].r)}function c(){if(e){var a,l=e.length,_;for(n=new Array(l),a=0;a<l;++a)_=e[a],n[_.index]=+t(_,a,e)}}return s.initialize=function(a,l){e=a,r=l,c()},s.iterations=function(a){return arguments.length?(o=+a,s):o},s.strength=function(a){return arguments.length?(i=+a,s):i},s.radius=function(a){return arguments.length?(t=typeof a=="function"?a:at(+a),c(),s):t},s}function io(t){return t.index}function Ht(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function oo(t){var e=io,n=_,r,i=at(30),o,s,u,c,a,l=1;t==null&&(t=[]);function _(x){return 1/Math.min(u[x.source.index],u[x.target.index])}function p(x){for(var h=0,w=t.length;h<l;++h)for(var M=0,g,k,A,N,I,P,R;M<w;++M)g=t[M],k=g.source,A=g.target,N=A.x+A.vx-k.x-k.vx||ot(a),I=A.y+A.vy-k.y-k.vy||ot(a),P=Math.sqrt(N*N+I*I),P=(P-o[M])/P*x*r[M],N*=P,I*=P,A.vx-=N*(R=c[M]),A.vy-=I*R,k.vx+=N*(R=1-R),k.vy+=I*R}function f(){if(s){var x,h=s.length,w=t.length,M=new Map(s.map((k,A)=>[e(k,A,s),k])),g;for(x=0,u=new Array(h);x<w;++x)g=t[x],g.index=x,typeof g.source!="object"&&(g.source=Ht(M,g.source)),typeof g.target!="object"&&(g.target=Ht(M,g.target)),u[g.source.index]=(u[g.source.index]||0)+1,u[g.target.index]=(u[g.target.index]||0)+1;for(x=0,c=new Array(w);x<w;++x)g=t[x],c[x]=u[g.source.index]/(u[g.source.index]+u[g.target.index]);r=new Array(w),v(),o=new Array(w),m()}}function v(){if(s)for(var x=0,h=t.length;x<h;++x)r[x]=+n(t[x],x,t)}function m(){if(s)for(var x=0,h=t.length;x<h;++x)o[x]=+i(t[x],x,t)}return p.initialize=function(x,h){s=x,a=h,f()},p.links=function(x){return arguments.length?(t=x,f(),p):t},p.id=function(x){return arguments.length?(e=x,p):e},p.iterations=function(x){return arguments.length?(l=+x,p):l},p.strength=function(x){return arguments.length?(n=typeof x=="function"?x:at(+x),v(),p):n},p.distance=function(x){return arguments.length?(i=typeof x=="function"?x:at(+x),m(),p):i},p}const so=1664525,ao=1013904223,Ut=4294967296;function uo(){let t=1;return()=>(t=(so*t+ao)%Ut)/Ut}function co(t){return t.x}function lo(t){return t.y}var fo=10,ho=Math.PI*(3-Math.sqrt(5));function po(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,u=new Map,c=Jt(_),a=wt("tick","end"),l=uo();t==null&&(t=[]);function _(){p(),a.call("tick",e),n<r&&(c.stop(),a.call("end",e))}function p(m){var x,h=t.length,w;m===void 0&&(m=1);for(var M=0;M<m;++M)for(n+=(o-n)*i,u.forEach(function(g){g(n)}),x=0;x<h;++x)w=t[x],w.fx==null?w.x+=w.vx*=s:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=s:(w.y=w.fy,w.vy=0);return e}function f(){for(var m=0,x=t.length,h;m<x;++m){if(h=t[m],h.index=m,h.fx!=null&&(h.x=h.fx),h.fy!=null&&(h.y=h.fy),isNaN(h.x)||isNaN(h.y)){var w=fo*Math.sqrt(.5+m),M=m*ho;h.x=w*Math.cos(M),h.y=w*Math.sin(M)}(isNaN(h.vx)||isNaN(h.vy))&&(h.vx=h.vy=0)}}function v(m){return m.initialize&&m.initialize(t,l),m}return f(),e={tick:p,restart:function(){return c.restart(_),e},stop:function(){return c.stop(),e},nodes:function(m){return arguments.length?(t=m,f(),u.forEach(v),e):t},alpha:function(m){return arguments.length?(n=+m,e):n},alphaMin:function(m){return arguments.length?(r=+m,e):r},alphaDecay:function(m){return arguments.length?(i=+m,e):+i},alphaTarget:function(m){return arguments.length?(o=+m,e):o},velocityDecay:function(m){return arguments.length?(s=1-m,e):1-s},randomSource:function(m){return arguments.length?(l=m,u.forEach(v),e):l},force:function(m,x){return arguments.length>1?(x==null?u.delete(m):u.set(m,v(x)),e):u.get(m)},find:function(m,x,h){var w=0,M=t.length,g,k,A,N,I;for(h==null?h=1/0:h*=h,w=0;w<M;++w)N=t[w],g=m-N.x,k=x-N.y,A=g*g+k*k,A<h&&(I=N,h=A);return I},on:function(m,x){return arguments.length>1?(a.on(m,x),e):a.on(m)}}}function go(){var t,e,n,r,i=at(-30),o,s=1,u=1/0,c=.81;function a(f){var v,m=t.length,x=te(t,co,lo).visitAfter(_);for(r=f,v=0;v<m;++v)e=t[v],x.visit(p)}function l(){if(t){var f,v=t.length,m;for(o=new Array(v),f=0;f<v;++f)m=t[f],o[m.index]=+i(m,f,t)}}function _(f){var v=0,m,x,h=0,w,M,g;if(f.length){for(w=M=g=0;g<4;++g)(m=f[g])&&(x=Math.abs(m.value))&&(v+=m.value,h+=x,w+=x*m.x,M+=x*m.y);f.x=w/h,f.y=M/h}else{m=f,m.x=m.data.x,m.y=m.data.y;do v+=o[m.data.index];while(m=m.next)}f.value=v}function p(f,v,m,x){if(!f.value)return!0;var h=f.x-e.x,w=f.y-e.y,M=x-v,g=h*h+w*w;if(M*M/c<g)return g<u&&(h===0&&(h=ot(n),g+=h*h),w===0&&(w=ot(n),g+=w*w),g<s&&(g=Math.sqrt(s*g)),e.vx+=h*f.value*r/g,e.vy+=w*f.value*r/g),!0;if(f.length||g>=u)return;(f.data!==e||f.next)&&(h===0&&(h=ot(n),g+=h*h),w===0&&(w=ot(n),g+=w*w),g<s&&(g=Math.sqrt(s*g)));do f.data!==e&&(M=o[f.data.index]*r/g,e.vx+=h*M,e.vy+=w*M);while(f=f.next)}return a.initialize=function(f,v){t=f,n=v,l()},a.strength=function(f){return arguments.length?(i=typeof f=="function"?f:at(+f),l(),a):i},a.distanceMin=function(f){return arguments.length?(s=f*f,a):Math.sqrt(s)},a.distanceMax=function(f){return arguments.length?(u=f*f,a):Math.sqrt(u)},a.theta=function(f){return arguments.length?(c=f*f,a):Math.sqrt(c)},a}const mt=t=>()=>t;function mo(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function rt(t,e,n){this.k=t,this.x=e,this.y=n}rt.prototype={constructor:rt,scale:function(t){return t===1?this:new rt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new rt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var be=new rt(1,0,0);rt.prototype;function kt(t){t.stopImmediatePropagation()}function ft(t){t.preventDefault(),t.stopImmediatePropagation()}function yo(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function vo(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function qt(){return this.__zoom||be}function xo(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function _o(){return navigator.maxTouchPoints||"ontouchstart"in this}function wo(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function bo(){var t=yo,e=vo,n=wo,r=xo,i=_o,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],u=250,c=Gr,a=wt("start","zoom","end"),l,_,p,f=500,v=150,m=0,x=10;function h(d){d.property("__zoom",qt).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",R).filter(i).on("touchstart.zoom",D).on("touchmove.zoom",W).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.transform=function(d,b,y,C){var T=d.selection?d.selection():d;T.property("__zoom",qt),d!==T?k(d,b,y,C):T.interrupt().each(function(){A(this,arguments).event(C).start().zoom(null,typeof b=="function"?b.apply(this,arguments):b).end()})},h.scaleBy=function(d,b,y,C){h.scaleTo(d,function(){var T=this.__zoom.k,z=typeof b=="function"?b.apply(this,arguments):b;return T*z},y,C)},h.scaleTo=function(d,b,y,C){h.transform(d,function(){var T=e.apply(this,arguments),z=this.__zoom,$=y==null?g(T):typeof y=="function"?y.apply(this,arguments):y,B=z.invert($),X=typeof b=="function"?b.apply(this,arguments):b;return n(M(w(z,X),$,B),T,s)},y,C)},h.translateBy=function(d,b,y,C){h.transform(d,function(){return n(this.__zoom.translate(typeof b=="function"?b.apply(this,arguments):b,typeof y=="function"?y.apply(this,arguments):y),e.apply(this,arguments),s)},null,C)},h.translateTo=function(d,b,y,C,T){h.transform(d,function(){var z=e.apply(this,arguments),$=this.__zoom,B=C==null?g(z):typeof C=="function"?C.apply(this,arguments):C;return n(be.translate(B[0],B[1]).scale($.k).translate(typeof b=="function"?-b.apply(this,arguments):-b,typeof y=="function"?-y.apply(this,arguments):-y),z,s)},C,T)};function w(d,b){return b=Math.max(o[0],Math.min(o[1],b)),b===d.k?d:new rt(b,d.x,d.y)}function M(d,b,y){var C=b[0]-y[0]*d.k,T=b[1]-y[1]*d.k;return C===d.x&&T===d.y?d:new rt(d.k,C,T)}function g(d){return[(+d[0][0]+ +d[1][0])/2,(+d[0][1]+ +d[1][1])/2]}function k(d,b,y,C){d.on("start.zoom",function(){A(this,arguments).event(C).start()}).on("interrupt.zoom end.zoom",function(){A(this,arguments).event(C).end()}).tween("zoom",function(){var T=this,z=arguments,$=A(T,z).event(C),B=e.apply(T,z),X=y==null?g(B):typeof y=="function"?y.apply(T,z):y,K=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),Y=T.__zoom,G=typeof b=="function"?b.apply(T,z):b,J=c(Y.invert(X).concat(K/Y.k),G.invert(X).concat(K/G.k));return function(H){if(H===1)H=G;else{var tt=J(H),Mt=K/tt[2];H=new rt(Mt,X[0]-tt[0]*Mt,X[1]-tt[1]*Mt)}$.zoom(null,H)}})}function A(d,b,y){return!y&&d.__zooming||new N(d,b)}function N(d,b){this.that=d,this.args=b,this.active=0,this.sourceEvent=null,this.extent=e.apply(d,b),this.taps=0}N.prototype={event:function(d){return d&&(this.sourceEvent=d),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(d,b){return this.mouse&&d!=="mouse"&&(this.mouse[1]=b.invert(this.mouse[0])),this.touch0&&d!=="touch"&&(this.touch0[1]=b.invert(this.touch0[0])),this.touch1&&d!=="touch"&&(this.touch1[1]=b.invert(this.touch1[0])),this.that.__zoom=b,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(d){var b=Q(this.that).datum();a.call(d,this.that,new mo(d,{sourceEvent:this.sourceEvent,target:h,type:d,transform:this.that.__zoom,dispatch:a}),b)}};function I(d,...b){if(!t.apply(this,arguments))return;var y=A(this,b).event(d),C=this.__zoom,T=Math.max(o[0],Math.min(o[1],C.k*Math.pow(2,r.apply(this,arguments)))),z=nt(d);if(y.wheel)(y.mouse[0][0]!==z[0]||y.mouse[0][1]!==z[1])&&(y.mouse[1]=C.invert(y.mouse[0]=z)),clearTimeout(y.wheel);else{if(C.k===T)return;y.mouse=[z,C.invert(z)],xt(this),y.start()}ft(d),y.wheel=setTimeout($,v),y.zoom("mouse",n(M(w(C,T),y.mouse[0],y.mouse[1]),y.extent,s));function $(){y.wheel=null,y.end()}}function P(d,...b){if(p||!t.apply(this,arguments))return;var y=d.currentTarget,C=A(this,b,!0).event(d),T=Q(d.view).on("mousemove.zoom",X,!0).on("mouseup.zoom",K,!0),z=nt(d,y),$=d.clientX,B=d.clientY;de(d.view),kt(d),C.mouse=[z,this.__zoom.invert(z)],xt(this),C.start();function X(Y){if(ft(Y),!C.moved){var G=Y.clientX-$,J=Y.clientY-B;C.moved=G*G+J*J>m}C.event(Y).zoom("mouse",n(M(C.that.__zoom,C.mouse[0]=nt(Y,y),C.mouse[1]),C.extent,s))}function K(Y){T.on("mousemove.zoom mouseup.zoom",null),ge(Y.view,C.moved),ft(Y),C.event(Y).end()}}function R(d,...b){if(t.apply(this,arguments)){var y=this.__zoom,C=nt(d.changedTouches?d.changedTouches[0]:d,this),T=y.invert(C),z=y.k*(d.shiftKey?.5:2),$=n(M(w(y,z),C,T),e.apply(this,b),s);ft(d),u>0?Q(this).transition().duration(u).call(k,$,C,d):Q(this).call(h.transform,$,C,d)}}function D(d,...b){if(t.apply(this,arguments)){var y=d.touches,C=y.length,T=A(this,b,d.changedTouches.length===C).event(d),z,$,B,X;for(kt(d),$=0;$<C;++$)B=y[$],X=nt(B,this),X=[X,this.__zoom.invert(X),B.identifier],T.touch0?!T.touch1&&T.touch0[2]!==X[2]&&(T.touch1=X,T.taps=0):(T.touch0=X,z=!0,T.taps=1+!!l);l&&(l=clearTimeout(l)),z&&(T.taps<2&&(_=X[0],l=setTimeout(function(){l=null},f)),xt(this),T.start())}}function W(d,...b){if(this.__zooming){var y=A(this,b).event(d),C=d.changedTouches,T=C.length,z,$,B,X;for(ft(d),z=0;z<T;++z)$=C[z],B=nt($,this),y.touch0&&y.touch0[2]===$.identifier?y.touch0[0]=B:y.touch1&&y.touch1[2]===$.identifier&&(y.touch1[0]=B);if($=y.that.__zoom,y.touch1){var K=y.touch0[0],Y=y.touch0[1],G=y.touch1[0],J=y.touch1[1],H=(H=G[0]-K[0])*H+(H=G[1]-K[1])*H,tt=(tt=J[0]-Y[0])*tt+(tt=J[1]-Y[1])*tt;$=w($,Math.sqrt(H/tt)),B=[(K[0]+G[0])/2,(K[1]+G[1])/2],X=[(Y[0]+J[0])/2,(Y[1]+J[1])/2]}else if(y.touch0)B=y.touch0[0],X=y.touch0[1];else return;y.zoom("touch",n(M($,B,X),y.extent,s))}}function F(d,...b){if(this.__zooming){var y=A(this,b).event(d),C=d.changedTouches,T=C.length,z,$;for(kt(d),p&&clearTimeout(p),p=setTimeout(function(){p=null},f),z=0;z<T;++z)$=C[z],y.touch0&&y.touch0[2]===$.identifier?delete y.touch0:y.touch1&&y.touch1[2]===$.identifier&&delete y.touch1;if(y.touch1&&!y.touch0&&(y.touch0=y.touch1,delete y.touch1),y.touch0)y.touch0[1]=this.__zoom.invert(y.touch0[0]);else if(y.end(),y.taps===2&&($=nt($,this),Math.hypot(_[0]-$[0],_[1]-$[1])<x)){var B=Q(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return h.wheelDelta=function(d){return arguments.length?(r=typeof d=="function"?d:mt(+d),h):r},h.filter=function(d){return arguments.length?(t=typeof d=="function"?d:mt(!!d),h):t},h.touchable=function(d){return arguments.length?(i=typeof d=="function"?d:mt(!!d),h):i},h.extent=function(d){return arguments.length?(e=typeof d=="function"?d:mt([[+d[0][0],+d[0][1]],[+d[1][0],+d[1][1]]]),h):e},h.scaleExtent=function(d){return arguments.length?(o[0]=+d[0],o[1]=+d[1],h):[o[0],o[1]]},h.translateExtent=function(d){return arguments.length?(s[0][0]=+d[0][0],s[1][0]=+d[1][0],s[0][1]=+d[0][1],s[1][1]=+d[1][1],h):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},h.constrain=function(d){return arguments.length?(n=d,h):n},h.duration=function(d){return arguments.length?(u=+d,h):u},h.interpolate=function(d){return arguments.length?(c=d,h):c},h.on=function(){var d=a.on.apply(a,arguments);return d===a?h:d},h.clickDistance=function(d){return arguments.length?(m=(d=+d)*d,h):Math.sqrt(m)},h.tapDistance=function(d){return arguments.length?(x=+d,h):x},h}const So=async t=>{const{nodes:e,edges:n}=await Kt(t,["Claim"],[],"",!0,0,3,500),r=[...new Map(e.map(o=>[o.ref_id,o])).values()].filter(o=>o.node_type==="Claim"),i=[...new Map(n.map(o=>[`${o.source}-${o.target}`,o])).values()].filter(o=>o.edge_type!=="HAS_CLAIM");return{nodes:r,edges:i}},Mo=()=>{const t=E.useRef(null),{selectedEpisode:e}=ut(s=>s),[n,r]=E.useState(null),i=20,o=s=>Math.min(Math.max(s.length*7+20,60),200);return E.useEffect(()=>{e!=null&&e.ref_id&&So(e.ref_id).then(r)},[e==null?void 0:e.ref_id]),E.useEffect(()=>{if(!t.current||!n)return;const s=800,u=600,c=Q(t.current).attr("viewBox",[0,0,s,u]).attr("width","100%").attr("height","100%");c.selectAll("*").remove();const a=c.append("g"),l=bo().scaleExtent([.1,4]).on("zoom",h=>a.attr("transform",h.transform));c.call(l);const _=Ge().domain(["Claim"]).range(["#1f77b4"]),p=po(n.nodes).force("link",oo(n.edges).id(h=>h.ref_id).distance(120)).force("charge",go().strength(-50)).force("center",to(s/2,u/2)).force("collide",ro().radius(()=>100).strength(.5).iterations(1));a.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",i+8).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("fill","#999").attr("d","M0,-5L10,0L0,5");const f=a.append("g").selectAll("line").data(n.edges).enter().append("line").attr("stroke","#999").attr("stroke-opacity",.6).attr("stroke-width",2).attr("marker-end","url(#arrow)"),v=a.append("g").selectAll("circle").data(n.nodes).enter().append("circle").attr("r",i).attr("fill",h=>_(h.node_type)).attr("stroke","#fff").attr("stroke-width",1.5).call(x(p)),m=a.append("g").selectAll("foreignObject").data(n.nodes).enter().append("foreignObject").attr("width",h=>{var w;return o(((w=h.properties)==null?void 0:w.name)||"Claim")}).attr("height",30).attr("x",h=>{var w;return-o(((w=h.properties)==null?void 0:w.name)||"Claim")/2}).attr("y",i+5).html(h=>{var w;return`
      <div style="
        width: 100%;
        height: 100%;
        padding: 4px;
        font-size: 6px;
        color: #333;
        background-color: rgba(255,255,255,0.9);
        border-radius: 4px;
        border: 1px solid #ddd;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        word-wrap: break-word;
        overflow: hidden;
        text-align: center;
        display: flex;
        align-items: flex-start;
        justify-content: flex-start;
        padding: 2px;
        box-sizing: border-box;
      ">
        ${((w=h.properties)==null?void 0:w.name)||"Claim"}
      </div>
      `});p.on("tick",()=>{f.attr("x1",h=>h.source.x).attr("y1",h=>h.source.y).attr("x2",h=>h.target.x).attr("y2",h=>h.target.y),v.attr("cx",h=>h.x).attr("cy",h=>h.y),m.attr("x",h=>{var w;return h.x-o(((w=h.properties)==null?void 0:w.name)||"Claim")/2}).attr("y",h=>h.y+i+5)});function x(h){return Fr().on("start",(w,M)=>{w.active||h.alphaTarget(.3).restart(),M.fx=M.x,M.fy=M.y}).on("drag",(w,M)=>{M.fx=w.x,M.fy=w.y}).on("end",(w,M)=>{w.active||h.alphaTarget(0),M.fx=null,M.fy=null})}return()=>p.stop()},[n]),S.jsx("div",{className:"w-full h-full p-4 bg-white rounded shadow relative",children:S.jsx("div",{className:"w-full h-96 border border-gray-200 rounded",children:S.jsx("svg",{ref:t,className:"w-full h-full"})})})},Co=()=>{const{close:t,visible:e}=Ne("claim"),n=()=>{t()},r="full";return S.jsx(Ie,{id:"claim",kind:r,onClose:n,preventOutsideClose:!0,children:e&&S.jsx(Mo,{})})},Se=E.memo(()=>{const t=U(v=>v.isPlaying),e=U(v=>v.setIsPlaying),n=U(v=>v.setVolume),r=U(v=>v.setPlaybackSpeed),i=U(v=>v.playbackSpeed),o=U(v=>v.playerRef),[s,u]=E.useState(!1),c=[.5,1,1.5,2],a=()=>{if(o){const v=o.getCurrentTime()-15;o.seekTo(v,"seconds")}},l=()=>{if(o){const v=o.getCurrentTime()+15;o.seekTo(v,"seconds")}},_=()=>{e(!t)},p=()=>{u(!s),n(s?1:0)},f=()=>{const m=(c.indexOf(i)+1)%c.length,x=c[m];if(r(x),o){const h=o.getInternalPlayer();h&&typeof h.playbackRate<"u"&&(h.playbackRate=x)}};return S.jsxs(To,{children:[S.jsx(zo,{onClick:p,children:s?S.jsx(Qe,{}):S.jsx(Ze,{})}),S.jsx(Ao,{onClick:a,children:S.jsx("img",{alt:"",src:"/RewindIcon.svg"})}),S.jsx(ko,{"data-testid":"play-pause-button",onClick:_,size:"small",children:t?S.jsx(Ve,{"data-testid":"pause-icon"}):S.jsx(We,{"data-testid":"play-icon"})}),S.jsx(Eo,{onClick:l,children:S.jsx("img",{alt:"",src:"/ForwardIcon.svg"})}),S.jsxs(No,{onClick:f,children:[i,"x"]})]})});Se.displayName="Controls";const To=j(V).attrs({direction:"row",align:"center",justify:"flex-start"})`
  width: 200px;
  height: 54px;
  background: ${L.BG1};
  border-radius: 40px;
  margin-right: 30px;
  color: ${L.white};
  font-size: 20px;
  padding: 12px;
  justify-content: space-between;
  box-sizing: border-box;
`,ko=j(Le)`
  && {
    font-size: 36px;
    padding: 2px;
    overflow: hidden;
  }
`,Ao=j.div`
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 1px 0 0 1px;
  cursor: pointer;
  img {
    width: 20px;
    height: auto;
  }
`,Eo=j.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  img {
    width: 24px;
    height: auto;
  }
`,zo=j.div`
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  cursor: pointer;
  border-radius: 50%;
  transition: background-color 0.3s ease;
  color: ${L.GRAY6};

  svg {
    margin-top: 3px;
    width: 24px;
    height: 24px;
  }

  &:hover {
    background-color: ${L.DROPDOWN_BG};
  }
`,No=j.button`
  margin-top: 4px;
  background: ${L.BG1};
  color: ${L.GRAY6};
  border: none;
  width: 8px;
  border-radius: 20px;
  padding: 8px 20px 8px 8px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.3s ease;
`,Me=E.memo(({left:t,width:e,title:n})=>S.jsx(Io,{style:{left:`${t}%`,width:`calc(${e}%)`},children:S.jsx("div",{className:"title",children:n})}));Me.displayName="Chapter";const Io=j.div`
  position: absolute;
  top: -3px;
  height: 100%;
  top: 0%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;

  & + & {
    border-left: 0.1px solid ${L.white};
  }

  .title {
    position: absolute;
    bottom: calc(100% + 16px);
    display: none;
    color: ${L.white};
    text-align: center;
    left: 50%;
    transform: translateX(-50%);
  }

  &:hover {
    background-color: rgba(255, 255, 255, 0.2);
    .title {
      display: block;
    }
  }
`,Ce=E.memo(({chapters:t,duration:e})=>e?S.jsx(S.Fragment,{children:t.map((n,r)=>{var a,l,_,p,f;const i=(a=n==null?void 0:n.properties)!=null&&a.timestamp?Et(n.properties.timestamp)/1e3:0,o=(_=(l=t[r+1])==null?void 0:l.properties)!=null&&_.timestamp?Et((p=t[r+1].properties)==null?void 0:p.timestamp)/1e3:e,s=Math.floor(i/e*100),c=Math.floor(o/e*100)-s;return S.jsx(Me,{left:s,title:((f=n==null?void 0:n.properties)==null?void 0:f.name)||(n==null?void 0:n.name)||"",width:c},`${n.ref_id}_${r}`)})}):null);Ce.displayName="Chapters";const Te=E.memo(({type:t,left:e,img:n})=>{var c,a;const r=Qt(l=>l.normalizedSchemasByType),i=(c=r[t])==null?void 0:c.primary_color,o=(a=r[t])==null?void 0:a.icon,s=o?`/svg-icons/${o}.svg`:"",u={iconStart:n||s,color:i??L.THING};return S.jsx(Ro,{style:{left:`${e}%`},children:S.jsx(ke,{...u,label:t})})});Te.displayName="Marker";const ke=E.memo(({iconStart:t,color:e,label:n})=>S.jsx($o,{color:e,children:t&&S.jsx("img",{alt:n,className:"badge__img",onError:console.log,src:t})}));ke.displayName="Badge";const $o=j(V).attrs({direction:"row"})`
  cursor: pointer;
  background: ${({color:t})=>t};
  border-radius: 3px;
  overflow: hidden;
  justify-content: center;
  align-items: center;

  .badge__img {
    width: 10px;
    height: 10px;
    object-fit: contain;
  }
`,Ro=j.div`
  position: absolute;
  top: -6px;
  width: 12px;
  height: 12px;
  border-radius: 4px;
  background-color: ${L.white};
  transform: translateX(-50%);
  transform: translateX(-50%) translateY(-50%);
  top: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
`,Ae=E.memo(({markers:t,duration:e})=>S.jsx(S.Fragment,{children:t.map((n,r)=>{var u;const i=Math.floor(((n==null?void 0:n.start)||0)/e*100),o=(n==null?void 0:n.node_type)||"",s=((u=n==null?void 0:n.properties)==null?void 0:u.image_url)||"";return S.jsx(Te,{img:s,left:i,type:o},`${n.ref_id}_${r}`)})}));Ae.displayName="Markers";const Po=({duration:t,markers:e,handleProgressChange:n,playingTIme:r,chapters:i})=>{const o=10/t*100;return S.jsxs(Do,{children:[S.jsx(Fo,{max:t,onChange:n,value:r,width:o}),i&&S.jsx(Ee,{children:S.jsx(Ce,{chapters:i,duration:t})}),S.jsx(jo,{children:S.jsx(Ae,{duration:t,markers:e})})]})},Ee=j(V)`
  position: absolute;
  left: 0;
  right: 0;
  top: 50%;
  height: 96px;
  transform: translateY(-50%);
`,Do=j(V)`
  position: relative;
  flex: 1 1 100%;

  &:hover {
    ${Ee} {
      display: block;
    }
  }
`,jo=j(V)`
  position: absolute;
  left: 0;
  right: 0;
  top: 50%;
`,Fo=j(He)`
  && {
    z-index: 20;
    color: ${L.white};
    height: 3px;
    width: calc(100% - 12px);
    box-sizing: border-box;
    .MuiSlider-track {
      border: none;
    }
    .MuiSlider-thumb {
      width: ${({width:t})=>`${t}%`};
      height: 54px;
      border-radius: 8px;
      background-color: ${L.primaryBlue};
      opacity: 0.2;
      &:before {
        box-shadow: '0 4px 8px rgba(0,0,0,0.4)';
      }
      &:hover,
      &.Mui-focusVisible,
      &.Mui-active {
        box-shadow: none;
      }
    }
  }
`,Bo=({markers:t,chapters:e})=>{const{playingNode:n,playerRef:r}=U(a=>a),[i,o]=E.useState(0),s=n,u=E.useCallback((a,l)=>{const _=Array.isArray(l)?l[0]:l;r&&r.seekTo(_,"seconds")},[r]);E.useEffect(()=>{const a=setInterval(()=>{if(r&&o){const l=r.getCurrentTime();o(l)}},500);return()=>clearInterval(a)},[r,o]);const c=(r==null?void 0:r.getDuration())||0;return s?S.jsxs(Xo,{children:[S.jsx(Se,{}),S.jsx(Po,{chapters:e,duration:c,handleProgressChange:u,markers:t,playingTIme:i})]}):null},Xo=j(V).attrs({direction:"row",align:"center",justify:"space-between"})`
  padding: 20px;
  background: ${L.BG2};
  height: 96px;
  /* margin-top: 16px; */
  border-radius: 8px;
  box-sizing: border-box;
  margin-right: 4px;
`,Vo=(t,e)=>{let n=0,r=t.length-1;for(;n<=r;){const i=Math.floor((n+r)/2),o=t[i],{start:s,end:u}=o.properties;if(e>=s&&e<=u)return o;e<s?r=i-1:n=i+1}return null},Wo=({mediaUrl:t})=>{const e=E.useRef(null),[n,r]=E.useState("ready"),[i,o]=E.useState(!1),{setActiveEdge:s}=ee(y=>y),{dataInitial:u}=Zt(y=>y),{isPlaying:c,playingTime:a,setIsPlaying:l,setPlayingTime:_,setDuration:p,playingNode:f,volume:v,setHasError:m,resetPlayer:x,isSeeking:h,setIsSeeking:w,setPlayerRef:M,playerRef:g,playbackSpeed:k}=U(y=>y);E.useEffect(()=>()=>x(),[x]),E.useEffect(()=>{f&&!i&&(_(0),p(0),o(!1))},[f,_,p,o,i]),E.useEffect(()=>{h&&g&&(g.seekTo(a,"seconds"),w(!1))},[a,h,w,g]);const A=E.useCallback(()=>{l(!c)},[c,l]),N=()=>{m(!0),r("error")},I=E.useCallback(y=>{y.code},[A]);E.useEffect(()=>(window.addEventListener("keydown",I),()=>{window.removeEventListener("keydown",I)}),[I]);const P=E.useMemo(()=>((u==null?void 0:u.links.filter(T=>{var z;return(z=T==null?void 0:T.properties)==null?void 0:z.start}))||[]).slice().sort((T,z)=>{var $,B;return(($=T==null?void 0:T.properties)==null?void 0:$.start)-((B=z==null?void 0:z.properties)==null?void 0:B.start)}),[u]),R=y=>{if(!h){const C=y.playedSeconds,T=Vo(P,C);s(T||null)}},D=()=>{g&&r("ready")},W=E.useCallback(()=>{c||l(!0)},[l,c]),F=E.useCallback(()=>{c&&l(!1)},[l,c]),d=y=>{y.stopPropagation()},b=E.useCallback(y=>{!g&&y&&M(y)},[M,g]);return t?S.jsxs(Lo,{ref:e,tabIndex:0,children:[S.jsx(Yo,{isFullScreen:!1,children:S.jsx($e,{size:120,src:(f==null?void 0:f.image_url)||"",type:"clip"})}),S.jsx(Go,{isFullScreen:!1,onClick:d,children:S.jsx(Ue,{ref:b,height:"219px",onBuffer:()=>r("buffering"),onBufferEnd:()=>r("ready"),onError:N,onPause:F,onPlay:W,onProgress:R,onReady:D,playbackRate:k,playing:c,url:t||"",volume:v,width:"100%"})}),n==="error"?S.jsx(Oo,{className:"error-wrapper",children:"Error happened, please try later"}):null]}):null},Lo=j(V)`
  border-bottom: 1px solid rgba(0, 0, 0, 0.25);
  background: rgba(0, 0, 0, 0.2);
  position: relative;
  overflow: hidden;
  height: auto;
  &:focus {
    outline: none;
  }
`,Yo=j(V)`
  position: absolute;
  top: ${t=>t.isFullScreen?"38%":"18%"};
  left: 50%;
  transform: translateX(-50%);
  z-index: -1;
`,Oo=j(V)`
  height: 60px;
  padding: 12px 16px;
  color: ${L.primaryRed};
`,Go=j.div`
  margin: ${t=>t.isFullScreen?"80px auto":"0"};
  width: 100%;
  cursor: pointer;
`,Ho=E.memo(Wo),ze=E.forwardRef(({active:t,start:e,text:n},r)=>S.jsxs(Uo,{ref:r,className:Re({active:t}),children:[S.jsx(qo,{children:e}),S.jsx(Ko,{children:S.jsx("span",{children:n})})]}));ze.displayName="ParagraphComponent";const At=E.memo(ze,(t,e)=>t.active===e.active),Uo=j(V)`
  flex-direction: row;
  align-items: flex-start;
  font-size: 14px;
  padding: 8px 24px;
  &.active {
    background: ${L.AI_HIGHLIGHT};
  }
`,qo=j.span`
  background: ${L.lightBlue100};
  color: ${L.lightBlue500};
  padding: 2px;
  margin-right: 8px;
  border-radius: 4px;
`,Ko=j.div`
  margin: 0 2px;
  word-break: break-word;

  &.active {
    background: ${L.AI_HIGHLIGHT};
  }
`,Qo=({transcriptString:t,isFirst:e})=>{const[n,r]=E.useState(0),[i,o]=E.useState(!1),{playerRef:s}=U(p=>p),u=t.replace(/^["']|["']$/g,""),c=JSON.parse(u),a=E.useRef(null),l=E.useRef(null),_=E.useRef(null);return E.useEffect(()=>{const p=setInterval(()=>{if(s&&r){const f=s.getCurrentTime();r(f)}},100);return()=>clearInterval(p)},[s,r]),E.useEffect(()=>{const p=()=>{o(!0),_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{o(!1)},1e3)},f=l.current;return f&&f.addEventListener("scroll",p),()=>{f&&f.removeEventListener("scroll",p)}},[]),E.useEffect(()=>{!i&&a.current&&a.current.scrollIntoView({behavior:"smooth",block:"center"})},[n,i]),S.jsx(Zo,{ref:l,children:S.jsx(S.Fragment,{children:e?S.jsx(S.Fragment,{children:c[0].start>n?S.jsx(At,{active:!1,start:Ct(c[0].start),text:c[0].text}):S.jsx(S.Fragment,{children:c.map(p=>{const f=Ct(p.start),v=p.start<n&&n<p.end;return!e||p.start<=n+5?S.jsx(At,{ref:v?a:null,active:v,start:f,text:p.text},`${p.start}-${p.end}`):null})})}):S.jsx(S.Fragment,{children:c.map(p=>{const f=Ct(p.start),v=p.start<n&&n<p.end;return S.jsx(At,{ref:v?a:null,active:v,start:f,text:p.text},`${p.start}-${p.end}`)})})})})},Zo=j.div`
  width: 100%;
  height: 100%;
  overflow: scroll;
  padding-right: 4px;
`,Jo=({name:t})=>{var f;const e=ut(v=>v.clips),{playerRef:n}=U(v=>v),[r,i]=E.useState(0),[o,s]=E.useState(null),[u,c]=E.useState(!0),[a,l]=ee(v=>[v.setActiveNode,v.activeNode]),_=Ye(v=>v.simulation);E.useEffect(()=>{const v=setInterval(()=>{if(n&&i){const m=n.getCurrentTime();i(m)}},100);return()=>clearInterval(v)},[n,i]),E.useEffect(()=>{r&&(()=>{var x;const m=e.find(h=>{var g;const[w,M]=p((g=h==null?void 0:h.properties)==null?void 0:g.timestamp);return w<=r&&r<M});o&&(m==null?void 0:m.ref_id)===(o==null?void 0:o.ref_id)||!m||(c((m==null?void 0:m.ref_id)===((x=e[0])==null?void 0:x.ref_id)),s(m||null))})()},[r,e,o]),E.useEffect(()=>{if(o&&(!l||o.ref_id!==l.ref_id)){const v=_==null?void 0:_.nodes().find(m=>m.ref_id===o.ref_id);typeof(v==null?void 0:v.fx)=="number"&&a(v)}},[o,l,a,_]);const p=v=>v?v.split("-").map(Number):[0,0];return S.jsxs(ts,{children:[S.jsx(V,{className:"heading",children:t}),o?S.jsx(es,{direction:"row",children:((f=o.properties)==null?void 0:f.transcript)&&S.jsx(Qo,{isFirst:u,transcriptString:o.properties.transcript})}):null]})},ts=j(V)`
  .heading {
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 16px;
  }
  color: ${L.white};
  background: ${L.BG1};
  border-radius: 8px;
  padding: 24px;
  overflow-y: auto;
  flex: 1 1 100%;
`,es=j(V)`
  flex-wrap: wrap;
  flex: 1 1 100%;
  margin-left: -24px;
  margin-right: -24px;
`,ns=()=>{var e;const t=ut(n=>n.selectedEpisode);return S.jsxs(rs,{align:"stretch",basis:"100%",grow:1,shrink:1,children:[S.jsx(is,{children:((e=t==null?void 0:t.properties)==null?void 0:e.source_link)&&S.jsx(Ho,{mediaUrl:t.properties.source_link})}),S.jsx(Jo,{name:(t==null?void 0:t.name)||""})]})},rs=j(V)(({theme:t})=>({position:"relative",display:"flex",padding:"0 20px 0 20px",background:"transparent",width:"100%",height:"calc(100vh - 180px)",overflow:"auto",[t.breakpoints.up("sm")]:{width:qe,gap:"10px"}})),is=j(V)(({theme:t})=>({width:"100%",marginBottom:"20px",[t.breakpoints.up("sm")]:{width:"390px",margin:"0 auto"}})),os=t=>{const e=t.edges.filter(r=>{var i;return(i=r==null?void 0:r.properties)==null?void 0:i.start}).map(r=>({source:r.source,target:r.target,start:r.properties.start}));return t.nodes.filter(r=>t.edges.some(i=>i.source===r.ref_id||i.target===r.ref_id)).map(r=>{const i=e.find(o=>r.ref_id===o.source||r.ref_id===o.target);return{...r,start:(i==null?void 0:i.start)||0}}).filter(r=>r&&r.node_type!=="Clip"&&r.node_type!=="Episode"&&r.node_type!=="Show")},Ps=()=>{const t=Zt(f=>f.addNewNode),e=ut(f=>f.clips),n=ut(f=>f.fetchEpisodeData),r=ut(f=>f.chapters),i=E.useRef(null),o=E.useRef(null),s=E.useRef(null),u=E.useRef(null),[c,a]=E.useState([]),{setSchemas:l}=Qt(f=>f),_=Pe(),{episodeId:p}=De();return E.useEffect(()=>{(async()=>{try{const v=await Fe();l(v.schemas.filter(m=>!m.is_deleted))}catch(v){console.error("Error fetching schema:",v)}})()},[l]),E.useEffect(()=>{p&&(async()=>{try{n(p||"")}catch(v){_("/"),console.error("Error fetching initial data:",v)}})()},[p,_,n]),E.useEffect(()=>{if(!e||!r)return;(async()=>{var v,m,x,h;try{const w=(e==null?void 0:e.map(k=>k.ref_id).filter(Boolean))||[],M=[],g={nodes:((v=s.current)==null?void 0:v.nodes)||[],edges:((m=s.current)==null?void 0:m.edges)||[]};for(const k of w){const A=await Kt(k,["-Clip","-Episode"],[],"",!0,0,2,50),N=A.nodes.filter(P=>P.node_type==="Claim"),I=A.edges.filter(P=>N.some(R=>R.ref_id===P.source||R.ref_id===P.target));if(u.current={nodes:[...((x=u.current)==null?void 0:x.nodes)||[],...N],edges:[...((h=u.current)==null?void 0:h.edges)||[],...I]},A){const R=os(A).map(D=>{var F;const W=((F=r.find(d=>{var b;return D.start&&Et(((b=d==null?void 0:d.properties)==null?void 0:b.timestamp)||"")>=D.start*1e3}))==null?void 0:F.ref_id)||"";return{...D,neighbourHood:W}});g.nodes.push(...R||[]),g.edges.push(...(A==null?void 0:A.edges)||[]),M.push(...R),s.current=g}}a(M)}catch(w){console.error("Error processing clip nodes:",w)}})()},[e,a,r,t]),E.useEffect(()=>{const f=v=>{var x;const{playerRef:m}=U.getState();if(o.current!==null){if(v-o.current>2e3){if(s.current&&m){const{nodes:w,edges:M}=s.current,g=m==null?void 0:m.getCurrentTime(),[k,A]=M.reduce(([F,d],b)=>{var y,C;return((y=b==null?void 0:b.properties)==null?void 0:y.start)!==void 0&&((C=b==null?void 0:b.properties)==null?void 0:C.start)<g+1?F.push(b):d.push(b),[F,d]},[[],[]]),[N,I]=w.reduce(([F,d],b)=>(k.some(y=>y.target===b.ref_id||y.source===b.ref_id)?F.push(b):d.push(b),[F,d]),[[],[]]);s.current={nodes:I,edges:A};const[P,R]=(((x=u.current)==null?void 0:x.edges)||[]).reduce(([F,d],b)=>{var y,C;if(N.some(T=>T.ref_id===b.source)){const T=(((y=u.current)==null?void 0:y.nodes)||[]).find(z=>z.ref_id===b.target);T&&(F.push(T),d.push(b))}else if(N.some(T=>T.ref_id===b.target)){const T=(((C=u.current)==null?void 0:C.nodes)||[]).find(z=>z.ref_id===b.source);T&&(F.push(T),d.push(b))}return[F,d]},[[],[]]),D=[...N,...P],W=[...k,...R];(D.length||W.length)&&t({nodes:D,edges:W})}o.current=v}}else o.current=v;i.current=requestAnimationFrame(f)};return i.current=requestAnimationFrame(f),()=>{i.current&&cancelAnimationFrame(i.current)}},[s,t]),S.jsxs(ss,{children:[S.jsx(as,{direction:"row",children:S.jsxs(S.Fragment,{children:[S.jsxs(V,{children:[S.jsx(V,{children:S.jsx(je,{})}),S.jsx(ns,{})]}),S.jsx(us,{children:S.jsx(V,{basis:"100%",grow:1,shrink:1,children:S.jsx(Ke,{})})})]})}),S.jsx(cs,{children:S.jsx(Bo,{chapters:r,markers:c})}),S.jsx(Co,{})]})},ss=j.div`
  display: flex;
  flex-direction: column;
  height: 100vh;
  width: 100%;
`,as=j(V)`
  flex: 1;
  overflow: hidden;
`,us=j(V)`
  flex-basis: 100%;
  flex-shrink: 1;
  flex-grow: 1;
  padding: 16px 16px 16px 0;
`,cs=j(V)`
  padding: 16px 16px 16px 0;
  margin-left: 18px;
`;export{Ps as MindSet};
