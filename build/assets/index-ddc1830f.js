import{r as N,g as L,j as S,o as Kt,p as ze,q as Ie,s as F,F as W,t as Qt,c as Zt,A as $e,v as Re,i as Pe,w as De,H as je,x as Fe}from"./index-31a6658c.js";import{a as Be,d as wt,t as Jt,n as Xe,q as te,u as ut,b as U,c as Ve,e as We,I as Le,f as kt,g as ee,h as Ye}from"./index-ef8dc5ba.js";import{i as at,c as Bt,a as Xt,b as Oe,S as Ge,R as He,s as Ct,M as Ue}from"./index-9dc84181.js";import{U as qe}from"./index-510a1af5.js";import{M as Ke,V as Qe}from"./index-ae9ebe59.js";import"./ClipLoader-712521c5.js";import"./Skeleton-005dd837.js";import"./index-d7227c85.js";import"./SoundIcon-72b5790d.js";import"./CheckIcon-d4bdc304.js";import"./Stack-5a7def7d.js";import"./clsx-6e421cf8.js";import"./FormControlLabel-5426c19d.js";import"./Typography-4e07bf85.js";import"./createSvgIcon-81a6fb10.js";import"./isPlainObject-839c5f47.js";import"./index-51a69213.js";import"./index-1d806fd8.js";import"./index-b3bc5a8b.js";import"./three.module-4d3d7244.js";import"./TextareaAutosize-3f8f4bf3.js";import"./index-40c86be1.js";import"./SourcesTableIcon-6e7980aa.js";import"./DeleteNodeIcon-85b3fc34.js";import"./SucessFeedBackIcon-2461f694.js";function Vt(t,e,n){var r=new Be;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Nt="http://www.w3.org/1999/xhtml";const Wt={svg:"http://www.w3.org/2000/svg",xhtml:Nt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function bt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Wt.hasOwnProperty(e)?{space:Wt[e],local:t}:t}function Ze(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Nt&&e.documentElement.namespaceURI===Nt?e.createElement(t):e.createElementNS(n,t)}}function Je(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ne(t){var e=bt(t);return(e.local?Je:Ze)(e)}function tn(){}function Pt(t){return t==null?tn:function(){return this.querySelector(t)}}function en(t){typeof t!="function"&&(t=Pt(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=new Array(s),c,u,l=0;l<s;++l)(c=o[l])&&(u=t.call(c,c.__data__,l,o))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new O(r,this._parents)}function nn(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function rn(){return[]}function re(t){return t==null?rn:function(){return this.querySelectorAll(t)}}function on(t){return function(){return nn(t.apply(this,arguments))}}function sn(t){typeof t=="function"?t=on(t):t=re(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s=e[o],a=s.length,c,u=0;u<a;++u)(c=s[u])&&(r.push(t.call(c,c.__data__,u,s)),i.push(c));return new O(r,i)}function ie(t){return function(){return this.matches(t)}}function oe(t){return function(e){return e.matches(t)}}var an=Array.prototype.find;function un(t){return function(){return an.call(this.children,t)}}function cn(){return this.firstElementChild}function ln(t){return this.select(t==null?cn:un(typeof t=="function"?t:oe(t)))}var fn=Array.prototype.filter;function hn(){return Array.from(this.children)}function pn(t){return function(){return fn.call(this.children,t)}}function dn(t){return this.selectAll(t==null?hn:pn(typeof t=="function"?t:oe(t)))}function gn(t){typeof t!="function"&&(t=ie(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=[],c,u=0;u<s;++u)(c=o[u])&&t.call(c,c.__data__,u,o)&&a.push(c);return new O(r,this._parents)}function se(t){return new Array(t.length)}function mn(){return new O(this._enter||this._groups.map(se),this._parents)}function _t(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}_t.prototype={constructor:_t,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function yn(t){return function(){return t}}function vn(t,e,n,r,i,o){for(var s=0,a,c=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new _t(t,o[s]);for(;s<c;++s)(a=e[s])&&(i[s]=a)}function xn(t,e,n,r,i,o,s){var a,c,u=new Map,l=e.length,x=o.length,p=new Array(l),h;for(a=0;a<l;++a)(c=e[a])&&(p[a]=h=s.call(c,c.__data__,a,e)+"",u.has(h)?i[a]=c:u.set(h,c));for(a=0;a<x;++a)h=s.call(t,o[a],a,o)+"",(c=u.get(h))?(r[a]=c,c.__data__=o[a],u.delete(h)):n[a]=new _t(t,o[a]);for(a=0;a<l;++a)(c=e[a])&&u.get(p[a])===c&&(i[a]=c)}function _n(t){return t.__data__}function wn(t,e){if(!arguments.length)return Array.from(this,_n);var n=e?xn:vn,r=this._parents,i=this._groups;typeof t!="function"&&(t=yn(t));for(var o=i.length,s=new Array(o),a=new Array(o),c=new Array(o),u=0;u<o;++u){var l=r[u],x=i[u],p=x.length,h=bn(t.call(l,l&&l.__data__,u,r)),y=h.length,m=a[u]=new Array(y),_=s[u]=new Array(y),g=c[u]=new Array(p);n(l,x,m,_,g,h,e);for(var M=0,w=0,f,C;M<y;++M)if(f=m[M]){for(M>=w&&(w=M+1);!(C=_[w])&&++w<y;);f._next=C||null}}return s=new O(s,r),s._enter=a,s._exit=c,s}function bn(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Sn(){return new O(this._exit||this._groups.map(se),this._parents)}function Mn(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Cn(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),c=0;c<s;++c)for(var u=n[c],l=r[c],x=u.length,p=a[c]=new Array(x),h,y=0;y<x;++y)(h=u[y]||l[y])&&(p[y]=h);for(;c<i;++c)a[c]=n[c];return new O(a,this._parents)}function Tn(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function An(t){t||(t=En);function e(x,p){return x&&p?t(x.__data__,p.__data__):!x-!p}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],a=s.length,c=i[o]=new Array(a),u,l=0;l<a;++l)(u=s[l])&&(c[l]=u);c.sort(e)}return new O(i,this._parents).order()}function En(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function kn(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Nn(){return Array.from(this)}function zn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function In(){let t=0;for(const e of this)++t;return t}function $n(){return!this.node()}function Rn(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,s=i.length,a;o<s;++o)(a=i[o])&&t.call(a,a.__data__,o,i);return this}function Pn(t){return function(){this.removeAttribute(t)}}function Dn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function jn(t,e){return function(){this.setAttribute(t,e)}}function Fn(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Bn(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Xn(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Vn(t,e){var n=bt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Dn:Pn:typeof e=="function"?n.local?Xn:Bn:n.local?Fn:jn)(n,e))}function ae(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Wn(t){return function(){this.style.removeProperty(t)}}function Ln(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Yn(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function On(t,e,n){return arguments.length>1?this.each((e==null?Wn:typeof e=="function"?Yn:Ln)(t,e,n??"")):lt(this.node(),t)}function lt(t,e){return t.style.getPropertyValue(e)||ae(t).getComputedStyle(t,null).getPropertyValue(e)}function Gn(t){return function(){delete this[t]}}function Hn(t,e){return function(){this[t]=e}}function Un(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function qn(t,e){return arguments.length>1?this.each((e==null?Gn:typeof e=="function"?Un:Hn)(t,e)):this.node()[t]}function ue(t){return t.trim().split(/^|\s+/)}function Dt(t){return t.classList||new ce(t)}function ce(t){this._node=t,this._names=ue(t.getAttribute("class")||"")}ce.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function le(t,e){for(var n=Dt(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function fe(t,e){for(var n=Dt(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Kn(t){return function(){le(this,t)}}function Qn(t){return function(){fe(this,t)}}function Zn(t,e){return function(){(e.apply(this,arguments)?le:fe)(this,t)}}function Jn(t,e){var n=ue(t+"");if(arguments.length<2){for(var r=Dt(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Zn:e?Kn:Qn)(n,e))}function tr(){this.textContent=""}function er(t){return function(){this.textContent=t}}function nr(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function rr(t){return arguments.length?this.each(t==null?tr:(typeof t=="function"?nr:er)(t)):this.node().textContent}function ir(){this.innerHTML=""}function or(t){return function(){this.innerHTML=t}}function sr(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function ar(t){return arguments.length?this.each(t==null?ir:(typeof t=="function"?sr:or)(t)):this.node().innerHTML}function ur(){this.nextSibling&&this.parentNode.appendChild(this)}function cr(){return this.each(ur)}function lr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fr(){return this.each(lr)}function hr(t){var e=typeof t=="function"?t:ne(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function pr(){return null}function dr(t,e){var n=typeof t=="function"?t:ne(t),r=e==null?pr:typeof e=="function"?e:Pt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function gr(){var t=this.parentNode;t&&t.removeChild(this)}function mr(){return this.each(gr)}function yr(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vr(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function xr(t){return this.select(t?vr:yr)}function _r(t){return arguments.length?this.property("__data__",t):this.node().__data__}function wr(t){return function(e){t.call(this,e,this.__data__)}}function br(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Sr(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Mr(t,e,n){return function(){var r=this.__on,i,o=wr(e);if(r){for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Cr(t,e,n){var r=br(t+""),i,o=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(i=0,l=a[c];i<o;++i)if((s=r[i]).type===l.type&&s.name===l.name)return l.value}return}for(a=e?Mr:Sr,i=0;i<o;++i)this.each(a(r[i],e,n));return this}function he(t,e,n){var r=ae(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Tr(t,e){return function(){return he(this,t,e)}}function Ar(t,e){return function(){return he(this,t,e.apply(this,arguments))}}function Er(t,e){return this.each((typeof e=="function"?Ar:Tr)(t,e))}function*kr(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,s;i<o;++i)(s=r[i])&&(yield s)}var pe=[null];function O(t,e){this._groups=t,this._parents=e}function pt(){return new O([[document.documentElement]],pe)}function Nr(){return this}O.prototype=pt.prototype={constructor:O,select:en,selectAll:sn,selectChild:ln,selectChildren:dn,filter:gn,data:wn,enter:mn,exit:Sn,join:Mn,merge:Cn,selection:Nr,order:Tn,sort:An,call:kn,nodes:Nn,node:zn,size:In,empty:$n,each:Rn,attr:Vn,style:On,property:qn,classed:Jn,text:rr,html:ar,raise:cr,lower:fr,append:hr,insert:dr,remove:mr,clone:xr,datum:_r,on:Cr,dispatch:Er,[Symbol.iterator]:kr};function Z(t){return typeof t=="string"?new O([[document.querySelector(t)]],[document.documentElement]):new O([[t]],pe)}function zr(t){let e;for(;e=t.sourceEvent;)t=e;return t}function rt(t,e){if(t=zr(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Ir={passive:!1},ht={capture:!0,passive:!1};function Tt(t){t.stopImmediatePropagation()}function ct(t){t.preventDefault(),t.stopImmediatePropagation()}function de(t){var e=t.document.documentElement,n=Z(t).on("dragstart.drag",ct,ht);"onselectstart"in e?n.on("selectstart.drag",ct,ht):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function ge(t,e){var n=t.document.documentElement,r=Z(t).on("dragstart.drag",null);e&&(r.on("click.drag",ct,ht),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const dt=t=>()=>t;function zt(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:o,x:s,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}zt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function $r(t){return!t.ctrlKey&&!t.button}function Rr(){return this.parentNode}function Pr(t,e){return e??{x:t.x,y:t.y}}function Dr(){return navigator.maxTouchPoints||"ontouchstart"in this}function jr(){var t=$r,e=Rr,n=Pr,r=Dr,i={},o=wt("start","drag","end"),s=0,a,c,u,l,x=0;function p(f){f.on("mousedown.drag",h).filter(r).on("touchstart.drag",_).on("touchmove.drag",g,Ir).on("touchend.drag touchcancel.drag",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(f,C){if(!(l||!t.call(this,f,C))){var T=w(this,e.call(this,f,C),f,C,"mouse");T&&(Z(f.view).on("mousemove.drag",y,ht).on("mouseup.drag",m,ht),de(f.view),Tt(f),u=!1,a=f.clientX,c=f.clientY,T("start",f))}}function y(f){if(ct(f),!u){var C=f.clientX-a,T=f.clientY-c;u=C*C+T*T>x}i.mouse("drag",f)}function m(f){Z(f.view).on("mousemove.drag mouseup.drag",null),ge(f.view,u),ct(f),i.mouse("end",f)}function _(f,C){if(t.call(this,f,C)){var T=f.changedTouches,k=e.call(this,f,C),z=T.length,R,$;for(R=0;R<z;++R)($=w(this,k,f,C,T[R].identifier,T[R]))&&(Tt(f),$("start",f,T[R]))}}function g(f){var C=f.changedTouches,T=C.length,k,z;for(k=0;k<T;++k)(z=i[C[k].identifier])&&(ct(f),z("drag",f,C[k]))}function M(f){var C=f.changedTouches,T=C.length,k,z;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),k=0;k<T;++k)(z=i[C[k].identifier])&&(Tt(f),z("end",f,C[k]))}function w(f,C,T,k,z,R){var $=o.copy(),D=rt(R||T,C),X,j,d;if((d=n.call(f,new zt("beforestart",{sourceEvent:T,target:p,identifier:z,active:s,x:D[0],y:D[1],dx:0,dy:0,dispatch:$}),k))!=null)return X=d.x-D[0]||0,j=d.y-D[1]||0,function b(v,A,E){var I=D,P;switch(v){case"start":i[z]=b,P=s++;break;case"end":delete i[z],--s;case"drag":D=rt(E||A,C),P=s;break}$.call(v,f,new zt(v,{sourceEvent:A,subject:d,target:p,identifier:z,active:P,x:D[0]+X,y:D[1]+j,dx:D[0]-I[0],dy:D[1]-I[1],dispatch:$}),k)}}return p.filter=function(f){return arguments.length?(t=typeof f=="function"?f:dt(!!f),p):t},p.container=function(f){return arguments.length?(e=typeof f=="function"?f:dt(f),p):e},p.subject=function(f){return arguments.length?(n=typeof f=="function"?f:dt(f),p):n},p.touchable=function(f){return arguments.length?(r=typeof f=="function"?f:dt(!!f),p):r},p.on=function(){var f=o.on.apply(o,arguments);return f===o?p:f},p.clickDistance=function(f){return arguments.length?(x=(f=+f)*f,p):Math.sqrt(x)},p}var Lt=180/Math.PI,It={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function me(t,e,n,r,i,o){var s,a,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),t*r<e*n&&(t=-t,e=-e,c=-c,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Lt,skewX:Math.atan(c)*Lt,scaleX:s,scaleY:a}}var gt;function Fr(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?It:me(e.a,e.b,e.c,e.d,e.e,e.f)}function Br(t){return t==null||(gt||(gt=document.createElementNS("http://www.w3.org/2000/svg","g")),gt.setAttribute("transform",t),!(t=gt.transform.baseVal.consolidate()))?It:(t=t.matrix,me(t.a,t.b,t.c,t.d,t.e,t.f))}function ye(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,l,x,p,h,y){if(u!==x||l!==p){var m=h.push("translate(",null,e,null,n);y.push({i:m-4,x:at(u,x)},{i:m-2,x:at(l,p)})}else(x||p)&&h.push("translate("+x+e+p+n)}function s(u,l,x,p){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),p.push({i:x.push(i(x)+"rotate(",null,r)-2,x:at(u,l)})):l&&x.push(i(x)+"rotate("+l+r)}function a(u,l,x,p){u!==l?p.push({i:x.push(i(x)+"skewX(",null,r)-2,x:at(u,l)}):l&&x.push(i(x)+"skewX("+l+r)}function c(u,l,x,p,h,y){if(u!==x||l!==p){var m=h.push(i(h)+"scale(",null,",",null,")");y.push({i:m-4,x:at(u,x)},{i:m-2,x:at(l,p)})}else(x!==1||p!==1)&&h.push(i(h)+"scale("+x+","+p+")")}return function(u,l){var x=[],p=[];return u=t(u),l=t(l),o(u.translateX,u.translateY,l.translateX,l.translateY,x,p),s(u.rotate,l.rotate,x,p),a(u.skewX,l.skewX,x,p),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,x,p),u=l=null,function(h){for(var y=-1,m=p.length,_;++y<m;)x[(_=p[y]).i]=_.x(h);return x.join("")}}}var Xr=ye(Fr,"px, ","px)","deg)"),Vr=ye(Br,", ",")",")"),Wr=1e-12;function Yt(t){return((t=Math.exp(t))+1/t)/2}function Lr(t){return((t=Math.exp(t))-1/t)/2}function Yr(t){return((t=Math.exp(2*t))-1)/(t+1)}const Or=function t(e,n,r){function i(o,s){var a=o[0],c=o[1],u=o[2],l=s[0],x=s[1],p=s[2],h=l-a,y=x-c,m=h*h+y*y,_,g;if(m<Wr)g=Math.log(p/u)/e,_=function(k){return[a+k*h,c+k*y,u*Math.exp(e*k*g)]};else{var M=Math.sqrt(m),w=(p*p-u*u+r*m)/(2*u*n*M),f=(p*p-u*u-r*m)/(2*p*n*M),C=Math.log(Math.sqrt(w*w+1)-w),T=Math.log(Math.sqrt(f*f+1)-f);g=(T-C)/e,_=function(k){var z=k*g,R=Yt(C),$=u/(n*M)*(R*Yr(e*z+C)-Lr(C));return[a+$*h,c+$*y,u*R/Yt(e*z+C)]}}return _.duration=g*1e3*e/Math.SQRT2,_}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,c=a*a;return t(s,a,c)},i}(Math.SQRT2,2,4);var Gr=wt("start","end","cancel","interrupt"),Hr=[],ve=0,Ot=1,$t=2,yt=3,Gt=4,Rt=5,vt=6;function St(t,e,n,r,i,o){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Ur(t,n,{name:e,index:r,group:i,on:Gr,tween:Hr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ve})}function jt(t,e){var n=K(t,e);if(n.state>ve)throw new Error("too late; already scheduled");return n}function J(t,e){var n=K(t,e);if(n.state>yt)throw new Error("too late; already running");return n}function K(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Ur(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Jt(o,0,n.time);function o(u){n.state=Ot,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var l,x,p,h;if(n.state!==Ot)return c();for(l in r)if(h=r[l],h.name===n.name){if(h.state===yt)return Vt(s);h.state===Gt?(h.state=vt,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete r[l]):+l<e&&(h.state=vt,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete r[l])}if(Vt(function(){n.state===yt&&(n.state=Gt,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=$t,n.on.call("start",t,t.__data__,n.index,n.group),n.state===$t){for(n.state=yt,i=new Array(p=n.tween.length),l=0,x=-1;l<p;++l)(h=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++x]=h);i.length=x+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Rt,1),x=-1,p=i.length;++x<p;)i[x].call(t,l);n.state===Rt&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=vt,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function xt(t,e){var n=t.__transition,r,i,o=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){o=!1;continue}i=r.state>$t&&r.state<Rt,r.state=vt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}o&&delete t.__transition}}function qr(t){return this.each(function(){xt(this,t)})}function Kr(t,e){var n,r;return function(){var i=J(this,t),o=i.tween;if(o!==n){r=n=o;for(var s=0,a=r.length;s<a;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Qr(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=J(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},c=0,u=i.length;c<u;++c)if(i[c].name===e){i[c]=a;break}c===u&&i.push(a)}o.tween=i}}function Zr(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=K(this.node(),n).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((e==null?Kr:Qr)(n,t,e))}function Ft(t,e,n){var r=t._id;return t.each(function(){var i=J(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return K(i,r).value[e]}}function xe(t,e){var n;return(typeof e=="number"?at:e instanceof Bt?Xt:(n=Bt(e))?(e=n,Xt):Oe)(t,e)}function Jr(t){return function(){this.removeAttribute(t)}}function ti(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ei(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttribute(t);return s===i?null:s===r?o:o=e(r=s,n)}}function ni(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?o:o=e(r=s,n)}}function ri(t,e,n){var r,i,o;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=a+"",s===c?null:s===r&&c===i?o:(i=c,o=e(r=s,a)))}}function ii(t,e,n){var r,i,o;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=a+"",s===c?null:s===r&&c===i?o:(i=c,o=e(r=s,a)))}}function oi(t,e){var n=bt(t),r=n==="transform"?Vr:xe;return this.attrTween(t,typeof e=="function"?(n.local?ii:ri)(n,r,Ft(this,"attr."+t,e)):e==null?(n.local?ti:Jr)(n):(n.local?ni:ei)(n,r,e))}function si(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function ai(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ui(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&ai(t,o)),n}return i._value=e,i}function ci(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&si(t,o)),n}return i._value=e,i}function li(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=bt(t);return this.tween(n,(r.local?ui:ci)(r,e))}function fi(t,e){return function(){jt(this,t).delay=+e.apply(this,arguments)}}function hi(t,e){return e=+e,function(){jt(this,t).delay=e}}function pi(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?fi:hi)(e,t)):K(this.node(),e).delay}function di(t,e){return function(){J(this,t).duration=+e.apply(this,arguments)}}function gi(t,e){return e=+e,function(){J(this,t).duration=e}}function mi(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?di:gi)(e,t)):K(this.node(),e).duration}function yi(t,e){if(typeof e!="function")throw new Error;return function(){J(this,t).ease=e}}function vi(t){var e=this._id;return arguments.length?this.each(yi(e,t)):K(this.node(),e).ease}function xi(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;J(this,t).ease=n}}function _i(t){if(typeof t!="function")throw new Error;return this.each(xi(this._id,t))}function wi(t){typeof t!="function"&&(t=ie(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=[],c,u=0;u<s;++u)(c=o[u])&&t.call(c,c.__data__,u,o)&&a.push(c);return new ot(r,this._parents,this._name,this._id)}function bi(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var c=e[a],u=n[a],l=c.length,x=s[a]=new Array(l),p,h=0;h<l;++h)(p=c[h]||u[h])&&(x[h]=p);for(;a<r;++a)s[a]=e[a];return new ot(s,this._parents,this._name,this._id)}function Si(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Mi(t,e,n){var r,i,o=Si(e)?jt:J;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}function Ci(t,e){var n=this._id;return arguments.length<2?K(this.node(),n).on.on(t):this.each(Mi(n,t,e))}function Ti(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Ai(){return this.on("end.remove",Ti(this._id))}function Ei(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Pt(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a=r[s],c=a.length,u=o[s]=new Array(c),l,x,p=0;p<c;++p)(l=a[p])&&(x=t.call(l,l.__data__,p,a))&&("__data__"in l&&(x.__data__=l.__data__),u[p]=x,St(u[p],e,n,p,u,K(l,n)));return new ot(o,this._parents,e,n)}function ki(t){var e=this._name,n=this._id;typeof t!="function"&&(t=re(t));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var c=r[a],u=c.length,l,x=0;x<u;++x)if(l=c[x]){for(var p=t.call(l,l.__data__,x,c),h,y=K(l,n),m=0,_=p.length;m<_;++m)(h=p[m])&&St(h,e,n,m,p,y);o.push(p),s.push(l)}return new ot(o,s,e,n)}var Ni=pt.prototype.constructor;function zi(){return new Ni(this._groups,this._parents)}function Ii(t,e){var n,r,i;return function(){var o=lt(this,t),s=(this.style.removeProperty(t),lt(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}function _e(t){return function(){this.style.removeProperty(t)}}function $i(t,e,n){var r,i=n+"",o;return function(){var s=lt(this,t);return s===i?null:s===r?o:o=e(r=s,n)}}function Ri(t,e,n){var r,i,o;return function(){var s=lt(this,t),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(t),lt(this,t))),s===c?null:s===r&&c===i?o:(i=c,o=e(r=s,a))}}function Pi(t,e){var n,r,i,o="style."+e,s="end."+o,a;return function(){var c=J(this,t),u=c.on,l=c.value[o]==null?a||(a=_e(e)):void 0;(u!==n||i!==l)&&(r=(n=u).copy()).on(s,i=l),c.on=r}}function Di(t,e,n){var r=(t+="")=="transform"?Xr:xe;return e==null?this.styleTween(t,Ii(t,r)).on("end.style."+t,_e(t)):typeof e=="function"?this.styleTween(t,Ri(t,r,Ft(this,"style."+t,e))).each(Pi(this._id,t)):this.styleTween(t,$i(t,r,e),n).on("end.style."+t,null)}function ji(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Fi(t,e,n){var r,i;function o(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&ji(t,s,n)),r}return o._value=e,o}function Bi(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Fi(t,e,n??""))}function Xi(t){return function(){this.textContent=t}}function Vi(t){return function(){var e=t(this);this.textContent=e??""}}function Wi(t){return this.tween("text",typeof t=="function"?Vi(Ft(this,"text",t)):Xi(t==null?"":t+""))}function Li(t){return function(e){this.textContent=t.call(this,e)}}function Yi(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Li(i)),e}return r._value=t,r}function Oi(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Yi(t))}function Gi(){for(var t=this._name,e=this._id,n=we(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,c,u=0;u<a;++u)if(c=s[u]){var l=K(c,e);St(c,t,n,u,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new ot(r,this._parents,t,n)}function Hi(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var a={value:s},c={value:function(){--i===0&&o()}};n.each(function(){var u=J(this,r),l=u.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(c)),u.on=e}),i===0&&o()})}var Ui=0;function ot(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function we(){return++Ui}var nt=pt.prototype;ot.prototype={constructor:ot,select:Ei,selectAll:ki,selectChild:nt.selectChild,selectChildren:nt.selectChildren,filter:wi,merge:bi,selection:zi,transition:Gi,call:nt.call,nodes:nt.nodes,node:nt.node,size:nt.size,empty:nt.empty,each:nt.each,on:Ci,attr:oi,attrTween:li,style:Di,styleTween:Bi,text:Wi,textTween:Oi,remove:Ai,tween:Zr,delay:pi,duration:mi,ease:vi,easeVarying:_i,end:Hi,[Symbol.iterator]:nt[Symbol.iterator]};function qi(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Ki={time:null,delay:0,duration:250,ease:qi};function Qi(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Zi(t){var e,n;t instanceof ot?(e=t._id,t=t._name):(e=we(),(n=Ki).time=Xe(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,c,u=0;u<a;++u)(c=s[u])&&St(c,t,e,u,s,n||Qi(c,e));return new ot(r,this._parents,t,e)}pt.prototype.interrupt=qr;pt.prototype.transition=Zi;function Ji(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var o,s=n.length,a,c=0,u=0;for(o=0;o<s;++o)a=n[o],c+=a.x,u+=a.y;for(c=(c/s-t)*r,u=(u/s-e)*r,o=0;o<s;++o)a=n[o],a.x-=c,a.y-=u}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(t=+o,i):t},i.y=function(o){return arguments.length?(e=+o,i):e},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function q(t){return function(){return t}}function st(t){return(t()-.5)*1e-6}function to(t){return t.x+t.vx}function eo(t){return t.y+t.vy}function no(t){var e,n,r,i=1,o=1;typeof t!="function"&&(t=q(t==null?1:+t));function s(){for(var u,l=e.length,x,p,h,y,m,_,g=0;g<o;++g)for(x=te(e,to,eo).visitAfter(a),u=0;u<l;++u)p=e[u],m=n[p.index],_=m*m,h=p.x+p.vx,y=p.y+p.vy,x.visit(M);function M(w,f,C,T,k){var z=w.data,R=w.r,$=m+R;if(z){if(z.index>p.index){var D=h-z.x-z.vx,X=y-z.y-z.vy,j=D*D+X*X;j<$*$&&(D===0&&(D=st(r),j+=D*D),X===0&&(X=st(r),j+=X*X),j=($-(j=Math.sqrt(j)))/j*i,p.vx+=(D*=j)*($=(R*=R)/(_+R)),p.vy+=(X*=j)*$,z.vx-=D*($=1-$),z.vy-=X*$)}return}return f>h+$||T<h-$||C>y+$||k<y-$}}function a(u){if(u.data)return u.r=n[u.data.index];for(var l=u.r=0;l<4;++l)u[l]&&u[l].r>u.r&&(u.r=u[l].r)}function c(){if(e){var u,l=e.length,x;for(n=new Array(l),u=0;u<l;++u)x=e[u],n[x.index]=+t(x,u,e)}}return s.initialize=function(u,l){e=u,r=l,c()},s.iterations=function(u){return arguments.length?(o=+u,s):o},s.strength=function(u){return arguments.length?(i=+u,s):i},s.radius=function(u){return arguments.length?(t=typeof u=="function"?u:q(+u),c(),s):t},s}function ro(t){return t.index}function Ht(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function io(t){var e=ro,n=x,r,i=q(30),o,s,a,c,u,l=1;t==null&&(t=[]);function x(_){return 1/Math.min(a[_.source.index],a[_.target.index])}function p(_){for(var g=0,M=t.length;g<l;++g)for(var w=0,f,C,T,k,z,R,$;w<M;++w)f=t[w],C=f.source,T=f.target,k=T.x+T.vx-C.x-C.vx||st(u),z=T.y+T.vy-C.y-C.vy||st(u),R=Math.sqrt(k*k+z*z),R=(R-o[w])/R*_*r[w],k*=R,z*=R,T.vx-=k*($=c[w]),T.vy-=z*$,C.vx+=k*($=1-$),C.vy+=z*$}function h(){if(s){var _,g=s.length,M=t.length,w=new Map(s.map((C,T)=>[e(C,T,s),C])),f;for(_=0,a=new Array(g);_<M;++_)f=t[_],f.index=_,typeof f.source!="object"&&(f.source=Ht(w,f.source)),typeof f.target!="object"&&(f.target=Ht(w,f.target)),a[f.source.index]=(a[f.source.index]||0)+1,a[f.target.index]=(a[f.target.index]||0)+1;for(_=0,c=new Array(M);_<M;++_)f=t[_],c[_]=a[f.source.index]/(a[f.source.index]+a[f.target.index]);r=new Array(M),y(),o=new Array(M),m()}}function y(){if(s)for(var _=0,g=t.length;_<g;++_)r[_]=+n(t[_],_,t)}function m(){if(s)for(var _=0,g=t.length;_<g;++_)o[_]=+i(t[_],_,t)}return p.initialize=function(_,g){s=_,u=g,h()},p.links=function(_){return arguments.length?(t=_,h(),p):t},p.id=function(_){return arguments.length?(e=_,p):e},p.iterations=function(_){return arguments.length?(l=+_,p):l},p.strength=function(_){return arguments.length?(n=typeof _=="function"?_:q(+_),y(),p):n},p.distance=function(_){return arguments.length?(i=typeof _=="function"?_:q(+_),m(),p):i},p}const oo=1664525,so=1013904223,Ut=4294967296;function ao(){let t=1;return()=>(t=(oo*t+so)%Ut)/Ut}function uo(t){return t.x}function co(t){return t.y}var lo=10,fo=Math.PI*(3-Math.sqrt(5));function ho(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,c=Jt(x),u=wt("tick","end"),l=ao();t==null&&(t=[]);function x(){p(),u.call("tick",e),n<r&&(c.stop(),u.call("end",e))}function p(m){var _,g=t.length,M;m===void 0&&(m=1);for(var w=0;w<m;++w)for(n+=(o-n)*i,a.forEach(function(f){f(n)}),_=0;_<g;++_)M=t[_],M.fx==null?M.x+=M.vx*=s:(M.x=M.fx,M.vx=0),M.fy==null?M.y+=M.vy*=s:(M.y=M.fy,M.vy=0);return e}function h(){for(var m=0,_=t.length,g;m<_;++m){if(g=t[m],g.index=m,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var M=lo*Math.sqrt(.5+m),w=m*fo;g.x=M*Math.cos(w),g.y=M*Math.sin(w)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function y(m){return m.initialize&&m.initialize(t,l),m}return h(),e={tick:p,restart:function(){return c.restart(x),e},stop:function(){return c.stop(),e},nodes:function(m){return arguments.length?(t=m,h(),a.forEach(y),e):t},alpha:function(m){return arguments.length?(n=+m,e):n},alphaMin:function(m){return arguments.length?(r=+m,e):r},alphaDecay:function(m){return arguments.length?(i=+m,e):+i},alphaTarget:function(m){return arguments.length?(o=+m,e):o},velocityDecay:function(m){return arguments.length?(s=1-m,e):1-s},randomSource:function(m){return arguments.length?(l=m,a.forEach(y),e):l},force:function(m,_){return arguments.length>1?(_==null?a.delete(m):a.set(m,y(_)),e):a.get(m)},find:function(m,_,g){var M=0,w=t.length,f,C,T,k,z;for(g==null?g=1/0:g*=g,M=0;M<w;++M)k=t[M],f=m-k.x,C=_-k.y,T=f*f+C*C,T<g&&(z=k,g=T);return z},on:function(m,_){return arguments.length>1?(u.on(m,_),e):u.on(m)}}}function po(){var t,e,n,r,i=q(-30),o,s=1,a=1/0,c=.81;function u(h){var y,m=t.length,_=te(t,uo,co).visitAfter(x);for(r=h,y=0;y<m;++y)e=t[y],_.visit(p)}function l(){if(t){var h,y=t.length,m;for(o=new Array(y),h=0;h<y;++h)m=t[h],o[m.index]=+i(m,h,t)}}function x(h){var y=0,m,_,g=0,M,w,f;if(h.length){for(M=w=f=0;f<4;++f)(m=h[f])&&(_=Math.abs(m.value))&&(y+=m.value,g+=_,M+=_*m.x,w+=_*m.y);h.x=M/g,h.y=w/g}else{m=h,m.x=m.data.x,m.y=m.data.y;do y+=o[m.data.index];while(m=m.next)}h.value=y}function p(h,y,m,_){if(!h.value)return!0;var g=h.x-e.x,M=h.y-e.y,w=_-y,f=g*g+M*M;if(w*w/c<f)return f<a&&(g===0&&(g=st(n),f+=g*g),M===0&&(M=st(n),f+=M*M),f<s&&(f=Math.sqrt(s*f)),e.vx+=g*h.value*r/f,e.vy+=M*h.value*r/f),!0;if(h.length||f>=a)return;(h.data!==e||h.next)&&(g===0&&(g=st(n),f+=g*g),M===0&&(M=st(n),f+=M*M),f<s&&(f=Math.sqrt(s*f)));do h.data!==e&&(w=o[h.data.index]*r/f,e.vx+=g*w,e.vy+=M*w);while(h=h.next)}return u.initialize=function(h,y){t=h,n=y,l()},u.strength=function(h){return arguments.length?(i=typeof h=="function"?h:q(+h),l(),u):i},u.distanceMin=function(h){return arguments.length?(s=h*h,u):Math.sqrt(s)},u.distanceMax=function(h){return arguments.length?(a=h*h,u):Math.sqrt(a)},u.theta=function(h){return arguments.length?(c=h*h,u):Math.sqrt(c)},u}function go(t){var e=q(.1),n,r,i;typeof t!="function"&&(t=q(t==null?0:+t));function o(a){for(var c=0,u=n.length,l;c<u;++c)l=n[c],l.vy+=(i[c]-l.y)*r[c]*a}function s(){if(n){var a,c=n.length;for(r=new Array(c),i=new Array(c),a=0;a<c;++a)r[a]=isNaN(i[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(e=typeof a=="function"?a:q(+a),s(),o):e},o.y=function(a){return arguments.length?(t=typeof a=="function"?a:q(+a),s(),o):t},o}const mt=t=>()=>t;function mo(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function it(t,e,n){this.k=t,this.x=e,this.y=n}it.prototype={constructor:it,scale:function(t){return t===1?this:new it(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new it(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var be=new it(1,0,0);it.prototype;function At(t){t.stopImmediatePropagation()}function ft(t){t.preventDefault(),t.stopImmediatePropagation()}function yo(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function vo(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function qt(){return this.__zoom||be}function xo(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function _o(){return navigator.maxTouchPoints||"ontouchstart"in this}function wo(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function bo(){var t=yo,e=vo,n=wo,r=xo,i=_o,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Or,u=wt("start","zoom","end"),l,x,p,h=500,y=150,m=0,_=10;function g(d){d.property("__zoom",qt).on("wheel.zoom",z,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",$).filter(i).on("touchstart.zoom",D).on("touchmove.zoom",X).on("touchend.zoom touchcancel.zoom",j).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(d,b,v,A){var E=d.selection?d.selection():d;E.property("__zoom",qt),d!==E?C(d,b,v,A):E.interrupt().each(function(){T(this,arguments).event(A).start().zoom(null,typeof b=="function"?b.apply(this,arguments):b).end()})},g.scaleBy=function(d,b,v,A){g.scaleTo(d,function(){var E=this.__zoom.k,I=typeof b=="function"?b.apply(this,arguments):b;return E*I},v,A)},g.scaleTo=function(d,b,v,A){g.transform(d,function(){var E=e.apply(this,arguments),I=this.__zoom,P=v==null?f(E):typeof v=="function"?v.apply(this,arguments):v,B=I.invert(P),V=typeof b=="function"?b.apply(this,arguments):b;return n(w(M(I,V),P,B),E,s)},v,A)},g.translateBy=function(d,b,v,A){g.transform(d,function(){return n(this.__zoom.translate(typeof b=="function"?b.apply(this,arguments):b,typeof v=="function"?v.apply(this,arguments):v),e.apply(this,arguments),s)},null,A)},g.translateTo=function(d,b,v,A,E){g.transform(d,function(){var I=e.apply(this,arguments),P=this.__zoom,B=A==null?f(I):typeof A=="function"?A.apply(this,arguments):A;return n(be.translate(B[0],B[1]).scale(P.k).translate(typeof b=="function"?-b.apply(this,arguments):-b,typeof v=="function"?-v.apply(this,arguments):-v),I,s)},A,E)};function M(d,b){return b=Math.max(o[0],Math.min(o[1],b)),b===d.k?d:new it(b,d.x,d.y)}function w(d,b,v){var A=b[0]-v[0]*d.k,E=b[1]-v[1]*d.k;return A===d.x&&E===d.y?d:new it(d.k,A,E)}function f(d){return[(+d[0][0]+ +d[1][0])/2,(+d[0][1]+ +d[1][1])/2]}function C(d,b,v,A){d.on("start.zoom",function(){T(this,arguments).event(A).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(A).end()}).tween("zoom",function(){var E=this,I=arguments,P=T(E,I).event(A),B=e.apply(E,I),V=v==null?f(B):typeof v=="function"?v.apply(E,I):v,Q=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),Y=E.__zoom,G=typeof b=="function"?b.apply(E,I):b,tt=c(Y.invert(V).concat(Q/Y.k),G.invert(V).concat(Q/G.k));return function(H){if(H===1)H=G;else{var et=tt(H),Mt=Q/et[2];H=new it(Mt,V[0]-et[0]*Mt,V[1]-et[1]*Mt)}P.zoom(null,H)}})}function T(d,b,v){return!v&&d.__zooming||new k(d,b)}function k(d,b){this.that=d,this.args=b,this.active=0,this.sourceEvent=null,this.extent=e.apply(d,b),this.taps=0}k.prototype={event:function(d){return d&&(this.sourceEvent=d),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(d,b){return this.mouse&&d!=="mouse"&&(this.mouse[1]=b.invert(this.mouse[0])),this.touch0&&d!=="touch"&&(this.touch0[1]=b.invert(this.touch0[0])),this.touch1&&d!=="touch"&&(this.touch1[1]=b.invert(this.touch1[0])),this.that.__zoom=b,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(d){var b=Z(this.that).datum();u.call(d,this.that,new mo(d,{sourceEvent:this.sourceEvent,target:g,type:d,transform:this.that.__zoom,dispatch:u}),b)}};function z(d,...b){if(!t.apply(this,arguments))return;var v=T(this,b).event(d),A=this.__zoom,E=Math.max(o[0],Math.min(o[1],A.k*Math.pow(2,r.apply(this,arguments)))),I=rt(d);if(v.wheel)(v.mouse[0][0]!==I[0]||v.mouse[0][1]!==I[1])&&(v.mouse[1]=A.invert(v.mouse[0]=I)),clearTimeout(v.wheel);else{if(A.k===E)return;v.mouse=[I,A.invert(I)],xt(this),v.start()}ft(d),v.wheel=setTimeout(P,y),v.zoom("mouse",n(w(M(A,E),v.mouse[0],v.mouse[1]),v.extent,s));function P(){v.wheel=null,v.end()}}function R(d,...b){if(p||!t.apply(this,arguments))return;var v=d.currentTarget,A=T(this,b,!0).event(d),E=Z(d.view).on("mousemove.zoom",V,!0).on("mouseup.zoom",Q,!0),I=rt(d,v),P=d.clientX,B=d.clientY;de(d.view),At(d),A.mouse=[I,this.__zoom.invert(I)],xt(this),A.start();function V(Y){if(ft(Y),!A.moved){var G=Y.clientX-P,tt=Y.clientY-B;A.moved=G*G+tt*tt>m}A.event(Y).zoom("mouse",n(w(A.that.__zoom,A.mouse[0]=rt(Y,v),A.mouse[1]),A.extent,s))}function Q(Y){E.on("mousemove.zoom mouseup.zoom",null),ge(Y.view,A.moved),ft(Y),A.event(Y).end()}}function $(d,...b){if(t.apply(this,arguments)){var v=this.__zoom,A=rt(d.changedTouches?d.changedTouches[0]:d,this),E=v.invert(A),I=v.k*(d.shiftKey?.5:2),P=n(w(M(v,I),A,E),e.apply(this,b),s);ft(d),a>0?Z(this).transition().duration(a).call(C,P,A,d):Z(this).call(g.transform,P,A,d)}}function D(d,...b){if(t.apply(this,arguments)){var v=d.touches,A=v.length,E=T(this,b,d.changedTouches.length===A).event(d),I,P,B,V;for(At(d),P=0;P<A;++P)B=v[P],V=rt(B,this),V=[V,this.__zoom.invert(V),B.identifier],E.touch0?!E.touch1&&E.touch0[2]!==V[2]&&(E.touch1=V,E.taps=0):(E.touch0=V,I=!0,E.taps=1+!!l);l&&(l=clearTimeout(l)),I&&(E.taps<2&&(x=V[0],l=setTimeout(function(){l=null},h)),xt(this),E.start())}}function X(d,...b){if(this.__zooming){var v=T(this,b).event(d),A=d.changedTouches,E=A.length,I,P,B,V;for(ft(d),I=0;I<E;++I)P=A[I],B=rt(P,this),v.touch0&&v.touch0[2]===P.identifier?v.touch0[0]=B:v.touch1&&v.touch1[2]===P.identifier&&(v.touch1[0]=B);if(P=v.that.__zoom,v.touch1){var Q=v.touch0[0],Y=v.touch0[1],G=v.touch1[0],tt=v.touch1[1],H=(H=G[0]-Q[0])*H+(H=G[1]-Q[1])*H,et=(et=tt[0]-Y[0])*et+(et=tt[1]-Y[1])*et;P=M(P,Math.sqrt(H/et)),B=[(Q[0]+G[0])/2,(Q[1]+G[1])/2],V=[(Y[0]+tt[0])/2,(Y[1]+tt[1])/2]}else if(v.touch0)B=v.touch0[0],V=v.touch0[1];else return;v.zoom("touch",n(w(P,B,V),v.extent,s))}}function j(d,...b){if(this.__zooming){var v=T(this,b).event(d),A=d.changedTouches,E=A.length,I,P;for(At(d),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),I=0;I<E;++I)P=A[I],v.touch0&&v.touch0[2]===P.identifier?delete v.touch0:v.touch1&&v.touch1[2]===P.identifier&&delete v.touch1;if(v.touch1&&!v.touch0&&(v.touch0=v.touch1,delete v.touch1),v.touch0)v.touch0[1]=this.__zoom.invert(v.touch0[0]);else if(v.end(),v.taps===2&&(P=rt(P,this),Math.hypot(x[0]-P[0],x[1]-P[1])<_)){var B=Z(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return g.wheelDelta=function(d){return arguments.length?(r=typeof d=="function"?d:mt(+d),g):r},g.filter=function(d){return arguments.length?(t=typeof d=="function"?d:mt(!!d),g):t},g.touchable=function(d){return arguments.length?(i=typeof d=="function"?d:mt(!!d),g):i},g.extent=function(d){return arguments.length?(e=typeof d=="function"?d:mt([[+d[0][0],+d[0][1]],[+d[1][0],+d[1][1]]]),g):e},g.scaleExtent=function(d){return arguments.length?(o[0]=+d[0],o[1]=+d[1],g):[o[0],o[1]]},g.translateExtent=function(d){return arguments.length?(s[0][0]=+d[0][0],s[1][0]=+d[1][0],s[0][1]=+d[0][1],s[1][1]=+d[1][1],g):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},g.constrain=function(d){return arguments.length?(n=d,g):n},g.duration=function(d){return arguments.length?(a=+d,g):a},g.interpolate=function(d){return arguments.length?(c=d,g):c},g.on=function(){var d=u.on.apply(u,arguments);return d===u?g:d},g.clickDistance=function(d){return arguments.length?(m=(d=+d)*d,g):Math.sqrt(m)},g.tapDistance=function(d){return arguments.length?(_=+d,g):_},g}const So=async t=>{const{nodes:e,edges:n}=await Kt(t,["Claim"],[],"",!0,0,3,500),r=[...new Map(e.map(o=>[o.ref_id,o])).values()].filter(o=>o.node_type==="Claim"),i=[...new Map(n.map(o=>[`${o.source}-${o.target}`,o])).values()].filter(o=>o.edge_type!=="HAS_CLAIM");return{nodes:r,edges:i}},Mo=()=>{const t=N.useRef(null),{selectedEpisode:e}=ut(c=>c),[n,r]=N.useState(null),[i,o]=N.useState([]),s=c=>Math.min(Math.max(c.length*7+20,60),200),a=30;return N.useEffect(()=>{const c=async()=>{const u=await So(e.ref_id),l=[],x=[];u.nodes.forEach(h=>{u.edges.some(m=>m.source===h.ref_id||m.target===h.ref_id)?x.push(h):l.push(h)});const p=[...x,...l];r({nodes:p,edges:u.edges}),o(l)};e!=null&&e.ref_id&&c()},[e==null?void 0:e.ref_id]),N.useEffect(()=>{if(!t.current||!n)return;const c=800,u=600,l=Z(t.current).attr("viewBox",[0,0,c,u]).attr("width","100%").attr("height","100%");l.selectAll("*").remove();const x=l.append("g"),p=bo().scaleExtent([.1,4]).on("zoom",w=>x.attr("transform",w.transform));l.call(p);const h=new Set(i.map(w=>w.ref_id)),y=ho(n.nodes).force("link",io(n.edges).id(w=>w.ref_id).distance(120)).force("charge",po().strength(-150)).force("center",Ji(c/2,u/2)).force("collide",no().radius(w=>{var f;return s(((f=w.properties)==null?void 0:f.name)||"Claim")/2+10}).strength(.7)).force("isolate",go(w=>h.has(w.ref_id)?u-100:u/2).strength(w=>h.has(w.ref_id)?.2:0));x.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("fill","#999").attr("d","M0,-5L10,0L0,5");const m=x.append("g").selectAll("line").data(n.edges).enter().append("line").attr("stroke","#999").attr("stroke-opacity",.6).attr("stroke-width",2).attr("marker-end","url(#arrow)"),_=x.append("g").selectAll("foreignObject").data(n.nodes).enter().append("foreignObject").attr("width",w=>{var f;return s(((f=w.properties)==null?void 0:f.name)||"Claim")}).attr("height",a).html(w=>{var f;return`
        <div style="
          width: 100%;
          height: 100%;
          font-size: 6px;
          color: #333;
          background-color:  ${L.BG2};
          border-radius: 6px;
          border: 1px solid #999;
          box-shadow: 0 1px 3px rgba(0,0,0,0.1);
          word-wrap: break-word;
          overflow: hidden;
          text-align: center;
          display: flex;
          align-items: flex-start;
          justify-content: flex-start;
          padding: 4px;
          box-sizing: border-box;
          cursor: move;
          color: white
        ">
          ${((f=w.properties)==null?void 0:f.name)||"Claim"}
        </div>
      `}).call(M(y)),g=new Map;n.edges.forEach(({source:w,target:f})=>{g.has(w)||g.set(w,new Set),g.has(f)||g.set(f,new Set),g.get(w).add(f),g.get(f).add(w)}),y.on("tick",()=>{m.attr("x1",w=>{var f;return w.source.x+s(((f=w.source.properties)==null?void 0:f.name)||"Claim")/2}).attr("y1",w=>w.source.y+a/2).attr("x2",w=>{var D,X,j;const f=w.source.x+s(((D=w.source.properties)==null?void 0:D.name)||"Claim")/2,C=w.source.y+a/2,T=w.target.x+s(((X=w.target.properties)==null?void 0:X.name)||"Claim")/2,k=w.target.y+a/2,z=T-f,R=k-C,$=Math.sqrt(z*z+R*R);return T-z/$*(s(((j=w.target.properties)==null?void 0:j.name)||"Claim")/2+5)}).attr("y2",w=>{var D,X;const f=w.source.x+s(((D=w.source.properties)==null?void 0:D.name)||"Claim")/2,C=w.source.y+a/2,T=w.target.x+s(((X=w.target.properties)==null?void 0:X.name)||"Claim")/2,k=w.target.y+a/2,z=T-f,R=k-C,$=Math.sqrt(z*z+R*R);return k-R/$*(a/2+5)}),_.attr("x",w=>w.x).attr("y",w=>w.y)});function M(w){return jr().on("start",(f,C)=>{f.active||w.alphaTarget(.3).restart(),C.fx=C.x,C.fy=C.y;const T=g.get(C.ref_id);T&&_.filter(k=>T.has(k.ref_id)).select("div").style("border","2px solid orange")}).on("drag",(f,C)=>{C.fx=f.x,C.fy=f.y}).on("end",(f,C)=>{f.active||w.alphaTarget(0),C.fx=null,C.fy=null,_.select("div").style("border","1px solid #999")})}return()=>y.stop()},[n,i]),S.jsx("div",{className:"w-full h-full p-4 bg-white rounded shadow relative",children:S.jsx("div",{className:"w-full h-96 border border-gray-200 rounded mb-4",children:S.jsx("svg",{ref:t,className:"w-full h-full"})})})},Co=()=>{const{close:t,visible:e}=ze("claim"),n=()=>{t()},r="full";return S.jsx(Ie,{id:"claim",kind:r,onClose:n,preventOutsideClose:!0,children:e&&S.jsx(Mo,{})})},Se=N.memo(()=>{const t=U(y=>y.isPlaying),e=U(y=>y.setIsPlaying),n=U(y=>y.setVolume),r=U(y=>y.setPlaybackSpeed),i=U(y=>y.playbackSpeed),o=U(y=>y.playerRef),[s,a]=N.useState(!1),c=[.5,1,1.5,2],u=()=>{if(o){const y=o.getCurrentTime()-15;o.seekTo(y,"seconds")}},l=()=>{if(o){const y=o.getCurrentTime()+15;o.seekTo(y,"seconds")}},x=()=>{e(!t)},p=()=>{a(!s),n(s?1:0)},h=()=>{const m=(c.indexOf(i)+1)%c.length,_=c[m];if(r(_),o){const g=o.getInternalPlayer();g&&typeof g.playbackRate<"u"&&(g.playbackRate=_)}};return S.jsxs(To,{children:[S.jsx(No,{onClick:p,children:s?S.jsx(Ke,{}):S.jsx(Qe,{})}),S.jsx(Eo,{onClick:u,children:S.jsx("img",{alt:"",src:"/RewindIcon.svg"})}),S.jsx(Ao,{"data-testid":"play-pause-button",onClick:x,size:"small",children:t?S.jsx(Ve,{"data-testid":"pause-icon"}):S.jsx(We,{"data-testid":"play-icon"})}),S.jsx(ko,{onClick:l,children:S.jsx("img",{alt:"",src:"/ForwardIcon.svg"})}),S.jsxs(zo,{onClick:h,children:[i,"x"]})]})});Se.displayName="Controls";const To=F(W).attrs({direction:"row",align:"center",justify:"flex-start"})`
  width: 200px;
  height: 54px;
  background: ${L.BG1};
  border-radius: 40px;
  margin-right: 30px;
  color: ${L.white};
  font-size: 20px;
  padding: 12px;
  justify-content: space-between;
  box-sizing: border-box;
`,Ao=F(Le)`
  && {
    font-size: 36px;
    padding: 2px;
    overflow: hidden;
  }
`,Eo=F.div`
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 1px 0 0 1px;
  cursor: pointer;
  img {
    width: 20px;
    height: auto;
  }
`,ko=F.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  img {
    width: 24px;
    height: auto;
  }
`,No=F.div`
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  cursor: pointer;
  border-radius: 50%;
  transition: background-color 0.3s ease;
  color: ${L.GRAY6};

  svg {
    margin-top: 3px;
    width: 24px;
    height: 24px;
  }

  &:hover {
    background-color: ${L.DROPDOWN_BG};
  }
`,zo=F.button`
  margin-top: 4px;
  background: ${L.BG1};
  color: ${L.GRAY6};
  border: none;
  width: 8px;
  border-radius: 20px;
  padding: 8px 20px 8px 8px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.3s ease;
`,Me=N.memo(({left:t,width:e,title:n})=>S.jsx(Io,{style:{left:`${t}%`,width:`calc(${e}%)`},children:S.jsx("div",{className:"title",children:n})}));Me.displayName="Chapter";const Io=F.div`
  position: absolute;
  top: -3px;
  height: 100%;
  top: 0%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;

  & + & {
    border-left: 0.1px solid ${L.white};
  }

  .title {
    position: absolute;
    bottom: calc(100% + 16px);
    display: none;
    color: ${L.white};
    text-align: center;
    left: 50%;
    transform: translateX(-50%);
  }

  &:hover {
    background-color: rgba(255, 255, 255, 0.2);
    .title {
      display: block;
    }
  }
`,Ce=N.memo(({chapters:t,duration:e})=>e?S.jsx(S.Fragment,{children:t.map((n,r)=>{var u,l,x,p,h;const i=(u=n==null?void 0:n.properties)!=null&&u.timestamp?kt(n.properties.timestamp)/1e3:0,o=(x=(l=t[r+1])==null?void 0:l.properties)!=null&&x.timestamp?kt((p=t[r+1].properties)==null?void 0:p.timestamp)/1e3:e,s=Math.floor(i/e*100),c=Math.floor(o/e*100)-s;return S.jsx(Me,{left:s,title:((h=n==null?void 0:n.properties)==null?void 0:h.name)||(n==null?void 0:n.name)||"",width:c},`${n.ref_id}_${r}`)})}):null);Ce.displayName="Chapters";const Te=N.memo(({type:t,left:e,img:n})=>{var c,u;const r=Qt(l=>l.normalizedSchemasByType),i=(c=r[t])==null?void 0:c.primary_color,o=(u=r[t])==null?void 0:u.icon,s=o?`/svg-icons/${o}.svg`:"",a={iconStart:n||s,color:i??L.THING};return S.jsx(Ro,{style:{left:`${e}%`},children:S.jsx(Ae,{...a,label:t})})});Te.displayName="Marker";const Ae=N.memo(({iconStart:t,color:e,label:n})=>S.jsx($o,{color:e,children:t&&S.jsx("img",{alt:n,className:"badge__img",onError:console.log,src:t})}));Ae.displayName="Badge";const $o=F(W).attrs({direction:"row"})`
  cursor: pointer;
  background: ${({color:t})=>t};
  border-radius: 3px;
  overflow: hidden;
  justify-content: center;
  align-items: center;

  .badge__img {
    width: 10px;
    height: 10px;
    object-fit: contain;
  }
`,Ro=F.div`
  position: absolute;
  top: -6px;
  width: 12px;
  height: 12px;
  border-radius: 4px;
  background-color: ${L.white};
  transform: translateX(-50%);
  transform: translateX(-50%) translateY(-50%);
  top: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
`,Ee=N.memo(({markers:t,duration:e})=>S.jsx(S.Fragment,{children:t.map((n,r)=>{var a;const i=Math.floor(((n==null?void 0:n.start)||0)/e*100),o=(n==null?void 0:n.node_type)||"",s=((a=n==null?void 0:n.properties)==null?void 0:a.image_url)||"";return S.jsx(Te,{img:s,left:i,type:o},`${n.ref_id}_${r}`)})}));Ee.displayName="Markers";const Po=({duration:t,markers:e,handleProgressChange:n,playingTIme:r,chapters:i})=>{const o=10/t*100;return S.jsxs(Do,{children:[S.jsx(Fo,{max:t,onChange:n,value:r,width:o}),i&&S.jsx(ke,{children:S.jsx(Ce,{chapters:i,duration:t})}),S.jsx(jo,{children:S.jsx(Ee,{duration:t,markers:e})})]})},ke=F(W)`
  position: absolute;
  left: 0;
  right: 0;
  top: 50%;
  height: 96px;
  transform: translateY(-50%);
`,Do=F(W)`
  position: relative;
  flex: 1 1 100%;

  &:hover {
    ${ke} {
      display: block;
    }
  }
`,jo=F(W)`
  position: absolute;
  left: 0;
  right: 0;
  top: 50%;
`,Fo=F(Ge)`
  && {
    z-index: 20;
    color: ${L.white};
    height: 3px;
    width: calc(100% - 12px);
    box-sizing: border-box;
    .MuiSlider-track {
      border: none;
    }
    .MuiSlider-thumb {
      width: ${({width:t})=>`${t}%`};
      height: 54px;
      border-radius: 8px;
      background-color: ${L.primaryBlue};
      opacity: 0.2;
      &:before {
        box-shadow: '0 4px 8px rgba(0,0,0,0.4)';
      }
      &:hover,
      &.Mui-focusVisible,
      &.Mui-active {
        box-shadow: none;
      }
    }
  }
`,Bo=({markers:t,chapters:e})=>{const{playingNode:n,playerRef:r}=U(u=>u),[i,o]=N.useState(0),s=n,a=N.useCallback((u,l)=>{const x=Array.isArray(l)?l[0]:l;r&&r.seekTo(x,"seconds")},[r]);N.useEffect(()=>{const u=setInterval(()=>{if(r&&o){const l=r.getCurrentTime();o(l)}},500);return()=>clearInterval(u)},[r,o]);const c=(r==null?void 0:r.getDuration())||0;return s?S.jsxs(Xo,{children:[S.jsx(Se,{}),S.jsx(Po,{chapters:e,duration:c,handleProgressChange:a,markers:t,playingTIme:i})]}):null},Xo=F(W).attrs({direction:"row",align:"center",justify:"space-between"})`
  padding: 20px;
  background: ${L.BG2};
  height: 96px;
  /* margin-top: 16px; */
  border-radius: 8px;
  box-sizing: border-box;
  margin-right: 4px;
`,Vo=(t,e)=>{let n=0,r=t.length-1;for(;n<=r;){const i=Math.floor((n+r)/2),o=t[i],{start:s,end:a}=o.properties;if(e>=s&&e<=a)return o;e<s?r=i-1:n=i+1}return null},Wo=({mediaUrl:t})=>{const e=N.useRef(null),[n,r]=N.useState("ready"),[i,o]=N.useState(!1),{setActiveEdge:s}=ee(v=>v),{dataInitial:a}=Zt(v=>v),{isPlaying:c,playingTime:u,setIsPlaying:l,setPlayingTime:x,setDuration:p,playingNode:h,volume:y,setHasError:m,resetPlayer:_,isSeeking:g,setIsSeeking:M,setPlayerRef:w,playerRef:f,playbackSpeed:C}=U(v=>v);N.useEffect(()=>()=>_(),[_]),N.useEffect(()=>{h&&!i&&(x(0),p(0),o(!1))},[h,x,p,o,i]),N.useEffect(()=>{g&&f&&(f.seekTo(u,"seconds"),M(!1))},[u,g,M,f]);const T=N.useCallback(()=>{l(!c)},[c,l]),k=()=>{m(!0),r("error")},z=N.useCallback(v=>{v.code},[T]);N.useEffect(()=>(window.addEventListener("keydown",z),()=>{window.removeEventListener("keydown",z)}),[z]);const R=N.useMemo(()=>((a==null?void 0:a.links.filter(E=>{var I;return(I=E==null?void 0:E.properties)==null?void 0:I.start}))||[]).slice().sort((E,I)=>{var P,B;return((P=E==null?void 0:E.properties)==null?void 0:P.start)-((B=I==null?void 0:I.properties)==null?void 0:B.start)}),[a]),$=v=>{if(!g){const A=v.playedSeconds,E=Vo(R,A);s(E||null)}},D=()=>{f&&r("ready")},X=N.useCallback(()=>{c||l(!0)},[l,c]),j=N.useCallback(()=>{c&&l(!1)},[l,c]),d=v=>{v.stopPropagation()},b=N.useCallback(v=>{!f&&v&&w(v)},[w,f]);return t?S.jsxs(Lo,{ref:e,tabIndex:0,children:[S.jsx(Yo,{isFullScreen:!1,children:S.jsx($e,{size:120,src:(h==null?void 0:h.image_url)||"",type:"clip"})}),S.jsx(Go,{isFullScreen:!1,onClick:d,children:S.jsx(He,{ref:b,height:"219px",onBuffer:()=>r("buffering"),onBufferEnd:()=>r("ready"),onError:k,onPause:j,onPlay:X,onProgress:$,onReady:D,playbackRate:C,playing:c,url:t||"",volume:y,width:"100%"})}),n==="error"?S.jsx(Oo,{className:"error-wrapper",children:"Error happened, please try later"}):null]}):null},Lo=F(W)`
  border-bottom: 1px solid rgba(0, 0, 0, 0.25);
  background: rgba(0, 0, 0, 0.2);
  position: relative;
  overflow: hidden;
  height: auto;
  &:focus {
    outline: none;
  }
`,Yo=F(W)`
  position: absolute;
  top: ${t=>t.isFullScreen?"38%":"18%"};
  left: 50%;
  transform: translateX(-50%);
  z-index: -1;
`,Oo=F(W)`
  height: 60px;
  padding: 12px 16px;
  color: ${L.primaryRed};
`,Go=F.div`
  margin: ${t=>t.isFullScreen?"80px auto":"0"};
  width: 100%;
  cursor: pointer;
`,Ho=N.memo(Wo),Ne=N.forwardRef(({active:t,start:e,text:n},r)=>S.jsxs(Uo,{ref:r,className:Re({active:t}),children:[S.jsx(qo,{children:e}),S.jsx(Ko,{children:S.jsx("span",{children:n})})]}));Ne.displayName="ParagraphComponent";const Et=N.memo(Ne,(t,e)=>t.active===e.active),Uo=F(W)`
  flex-direction: row;
  align-items: flex-start;
  font-size: 14px;
  padding: 8px 24px;
  &.active {
    background: ${L.AI_HIGHLIGHT};
  }
`,qo=F.span`
  background: ${L.lightBlue100};
  color: ${L.lightBlue500};
  padding: 2px;
  margin-right: 8px;
  border-radius: 4px;
`,Ko=F.div`
  margin: 0 2px;
  word-break: break-word;

  &.active {
    background: ${L.AI_HIGHLIGHT};
  }
`,Qo=({transcriptString:t,isFirst:e})=>{const[n,r]=N.useState(0),[i,o]=N.useState(!1),{playerRef:s}=U(p=>p),a=t.replace(/^["']|["']$/g,""),c=JSON.parse(a),u=N.useRef(null),l=N.useRef(null),x=N.useRef(null);return N.useEffect(()=>{const p=setInterval(()=>{if(s&&r){const h=s.getCurrentTime();r(h)}},100);return()=>clearInterval(p)},[s,r]),N.useEffect(()=>{const p=()=>{o(!0),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{o(!1)},1e3)},h=l.current;return h&&h.addEventListener("scroll",p),()=>{h&&h.removeEventListener("scroll",p)}},[]),N.useEffect(()=>{!i&&u.current&&u.current.scrollIntoView({behavior:"smooth",block:"center"})},[n,i]),S.jsx(Zo,{ref:l,children:S.jsx(S.Fragment,{children:e?S.jsx(S.Fragment,{children:c[0].start>n?S.jsx(Et,{active:!1,start:Ct(c[0].start),text:c[0].text}):S.jsx(S.Fragment,{children:c.map(p=>{const h=Ct(p.start),y=p.start<n&&n<p.end;return!e||p.start<=n+5?S.jsx(Et,{ref:y?u:null,active:y,start:h,text:p.text},`${p.start}-${p.end}`):null})})}):S.jsx(S.Fragment,{children:c.map(p=>{const h=Ct(p.start),y=p.start<n&&n<p.end;return S.jsx(Et,{ref:y?u:null,active:y,start:h,text:p.text},`${p.start}-${p.end}`)})})})})},Zo=F.div`
  width: 100%;
  height: 100%;
  overflow: scroll;
  padding-right: 4px;
`,Jo=({name:t})=>{var h;const e=ut(y=>y.clips),{playerRef:n}=U(y=>y),[r,i]=N.useState(0),[o,s]=N.useState(null),[a,c]=N.useState(!0),[u,l]=ee(y=>[y.setActiveNode,y.activeNode]),x=Ye(y=>y.simulation);N.useEffect(()=>{const y=setInterval(()=>{if(n&&i){const m=n.getCurrentTime();i(m)}},100);return()=>clearInterval(y)},[n,i]),N.useEffect(()=>{r&&(()=>{var _;const m=e.find(g=>{var f;const[M,w]=p((f=g==null?void 0:g.properties)==null?void 0:f.timestamp);return M<=r&&r<w});o&&(m==null?void 0:m.ref_id)===(o==null?void 0:o.ref_id)||!m||(c((m==null?void 0:m.ref_id)===((_=e[0])==null?void 0:_.ref_id)),s(m||null))})()},[r,e,o]),N.useEffect(()=>{if(o&&(!l||o.ref_id!==l.ref_id)){const y=x==null?void 0:x.nodes().find(m=>m.ref_id===o.ref_id);typeof(y==null?void 0:y.fx)=="number"&&u(y)}},[o,l,u,x]);const p=y=>y?y.split("-").map(Number):[0,0];return S.jsxs(ts,{children:[S.jsx(W,{className:"heading",children:t}),o?S.jsx(es,{direction:"row",children:((h=o.properties)==null?void 0:h.transcript)&&S.jsx(Qo,{isFirst:a,transcriptString:o.properties.transcript})}):null]})},ts=F(W)`
  .heading {
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 16px;
  }
  color: ${L.white};
  background: ${L.BG1};
  border-radius: 8px;
  padding: 24px;
  overflow-y: auto;
  flex: 1 1 100%;
`,es=F(W)`
  flex-wrap: wrap;
  flex: 1 1 100%;
  margin-left: -24px;
  margin-right: -24px;
`,ns=()=>{var e;const t=ut(n=>n.selectedEpisode);return S.jsxs(rs,{align:"stretch",basis:"100%",grow:1,shrink:1,children:[S.jsx(is,{children:((e=t==null?void 0:t.properties)==null?void 0:e.media_url)&&S.jsx(Ho,{mediaUrl:t.properties.media_url})}),S.jsx(Jo,{name:(t==null?void 0:t.name)||""})]})},rs=F(W)(({theme:t})=>({position:"relative",display:"flex",padding:"0 20px 0 20px",background:"transparent",width:"100%",height:"calc(100vh - 180px)",overflow:"auto",[t.breakpoints.up("sm")]:{width:Ue,gap:"10px"}})),is=F(W)(({theme:t})=>({width:"100%",marginBottom:"20px",[t.breakpoints.up("sm")]:{width:"390px",margin:"0 auto"}})),os=t=>{const e=t.edges.filter(r=>{var i;return(i=r==null?void 0:r.properties)==null?void 0:i.start}).map(r=>({source:r.source,target:r.target,start:r.properties.start}));return t.nodes.filter(r=>t.edges.some(i=>i.source===r.ref_id||i.target===r.ref_id)).map(r=>{const i=e.find(o=>r.ref_id===o.source||r.ref_id===o.target);return{...r,start:(i==null?void 0:i.start)||0}}).filter(r=>r&&r.node_type!=="Clip"&&r.node_type!=="Episode"&&r.node_type!=="Show")},Ps=()=>{const t=Zt(h=>h.addNewNode),e=ut(h=>h.clips),n=ut(h=>h.fetchEpisodeData),r=ut(h=>h.chapters),i=N.useRef(null),o=N.useRef(null),s=N.useRef(null),a=N.useRef(null),[c,u]=N.useState([]),{setSchemas:l}=Qt(h=>h),x=Pe(),{episodeId:p}=De();return N.useEffect(()=>{(async()=>{try{const y=await Fe();l(y.schemas.filter(m=>!m.is_deleted))}catch(y){console.error("Error fetching schema:",y)}})()},[l]),N.useEffect(()=>{p&&(async()=>{try{n(p||"")}catch(y){x("/"),console.error("Error fetching initial data:",y)}})()},[p,x,n]),N.useEffect(()=>{if(!e||!r)return;(async()=>{var y,m,_,g;try{const M=(e==null?void 0:e.map(C=>C.ref_id).filter(Boolean))||[],w=[],f={nodes:((y=s.current)==null?void 0:y.nodes)||[],edges:((m=s.current)==null?void 0:m.edges)||[]};for(const C of M){const T=await Kt(C,["-Clip","-Episode"],[],"",!0,0,2,50),k=T.nodes.filter(R=>R.node_type==="Claim"),z=T.edges.filter(R=>k.some($=>$.ref_id===R.source||$.ref_id===R.target));if(a.current={nodes:[...((_=a.current)==null?void 0:_.nodes)||[],...k],edges:[...((g=a.current)==null?void 0:g.edges)||[],...z]},T){const $=os(T).map(D=>{var j;const X=((j=r.find(d=>{var b;return D.start&&kt(((b=d==null?void 0:d.properties)==null?void 0:b.timestamp)||"")>=D.start*1e3}))==null?void 0:j.ref_id)||"";return{...D,neighbourHood:X}});f.nodes.push(...$||[]),f.edges.push(...(T==null?void 0:T.edges)||[]),w.push(...$),s.current=f}}u(w)}catch(M){console.error("Error processing clip nodes:",M)}})()},[e,u,r,t]),N.useEffect(()=>{const h=y=>{var _;const{playerRef:m}=U.getState();if(o.current!==null){if(y-o.current>2e3){if(s.current&&m){const{nodes:M,edges:w}=s.current,f=m==null?void 0:m.getCurrentTime(),[C,T]=w.reduce(([j,d],b)=>{var v,A;return((v=b==null?void 0:b.properties)==null?void 0:v.start)!==void 0&&((A=b==null?void 0:b.properties)==null?void 0:A.start)<f+1?j.push(b):d.push(b),[j,d]},[[],[]]),[k,z]=M.reduce(([j,d],b)=>(C.some(v=>v.target===b.ref_id||v.source===b.ref_id)?j.push(b):d.push(b),[j,d]),[[],[]]);s.current={nodes:z,edges:T};const[R,$]=(((_=a.current)==null?void 0:_.edges)||[]).reduce(([j,d],b)=>{var v,A;if(k.some(E=>E.ref_id===b.source)){const E=(((v=a.current)==null?void 0:v.nodes)||[]).find(I=>I.ref_id===b.target);E&&(j.push(E),d.push(b))}else if(k.some(E=>E.ref_id===b.target)){const E=(((A=a.current)==null?void 0:A.nodes)||[]).find(I=>I.ref_id===b.source);E&&(j.push(E),d.push(b))}return[j,d]},[[],[]]),D=[...k,...R],X=[...C,...$];(D.length||X.length)&&t({nodes:D,edges:X})}o.current=y}}else o.current=y;i.current=requestAnimationFrame(h)};return i.current=requestAnimationFrame(h),()=>{i.current&&cancelAnimationFrame(i.current)}},[s,t]),S.jsxs(ss,{children:[S.jsx(as,{direction:"row",children:S.jsxs(S.Fragment,{children:[S.jsxs(W,{children:[S.jsx(W,{children:S.jsx(je,{})}),S.jsx(ns,{})]}),S.jsx(us,{children:S.jsx(W,{basis:"100%",grow:1,shrink:1,children:S.jsx(qe,{})})})]})}),S.jsx(cs,{children:S.jsx(Bo,{chapters:r,markers:c})}),S.jsx(Co,{})]})},ss=F.div`
  display: flex;
  flex-direction: column;
  height: 100vh;
  width: 100%;
`,as=F(W)`
  flex: 1;
  overflow: hidden;
`,us=F(W)`
  flex-basis: 100%;
  flex-shrink: 1;
  flex-grow: 1;
  padding: 16px 16px 16px 0;
`,cs=F(W)`
  padding: 16px 16px 16px 0;
  margin-left: 18px;
`;export{Ps as MindSet};
